# [Work with 3D assets for games and apps](https://docs.microsoft.com/en-us/visualstudio/designers/working-with-3-d-assets-for-games-and-apps?view=vs-2019)

本文介绍 Visual Studio 工具，这些工具可用来创建或修改基于 DirectX 的游戏和应用的三维模型、纹理和着色器。

## Visual Studio 中的 DirectX 应用开发

DirectX 应用通常将编程逻辑、DirectX API、高级别着色语言 (HLSL) 程序与音频和三维可视化资产合并在一起，以提供丰富的交互式多媒体体验。 Visual Studio 包括可用于处理图像和纹理、三维模型和着色器的工具，无需离开 IDE 使用其他工具。 Visual Studio 工具尤其适用于创建占位符资产，该资产可用于添加生产就绪资产前测试代码或生成原型，还可用于调试应用前，检查和修改生产就绪资产。

以下是关于可在 Visual Studio 中处理的各种资产的详细信息。

### 图像和纹理

图像和纹理能够在游戏和应用中提供颜色和可视化细节。 在三维图中，纹理具有多种格式、类型和几何形状，以满足不同用途。 例如，法线贴图提供每像素曲面法线以实现更具体的三维模型照明，多维数据集映射提供所有方向的纹理以用于 sky-boxing、反射和球面纹理映射等。 纹理可以提供 mipmap，支持不同级别细节的高效绘制，且支持不同的颜色通道和颜色排序。 纹理可以各种压缩格式存储，从而减少专用图形内存占用，有助于 GPU 更有效地访问纹理。

可以使用 Visual Studio 图像编辑器处理许多常用类型和格式的图像和纹理。

### 三维模型

三维模型创建游戏和应用中的空间和形状。 按最小的方式，模型将三维空间中点的位置（称为顶点）和索引数据一起编码，以定义表示模型形状的线或三角形。 其他可以与这些顶点关联的数据，例如：颜色信息、常规矢量或应用程序特定的属性。 每个模型还可以定义对象范围的属性，例如，哪一个着色器用于计算对象图面的外观，哪一个纹理应用于它。

使用 Visual Studio 模型编辑器可以处理多种常用格式的三维模型。

### 着色器

着色器是在图形处理单元 (GPU) 上运行的特定于域的小型程序。 着色器确定三维模型转换为屏幕形状的方式，以及这些形状中的每个像素的着色方式。 通过创建着色器并将它应用到游戏或应用中的对象，可以为该对象提供唯一外观。

可以使用 Visual Studio 着色器设计器，它是一个基于图形的着色器设计工具，用户可以在不懂 HLSL 编程的情况下创建自定义可视化效果。

Note

有关如何开始 DirectX 编程的详细信息，请参阅 [DirectX](http://go.microsoft.com/fwlink/p/?LinkId=224633)。 有关如何调试基于 DirectX 的应用的详细信息，请参阅[图形诊断（调试 DirectX 图形）](https://docs.microsoft.com/zh-cn/visualstudio/debugger/graphics/visual-studio-graphics-diagnostics?view=vs-2019)。

## DirectX 版本兼容性

Visual Studio 使用 DirectX 呈现二维和三维资产。 可以选择 DirectX 11 呈现器或 Windows 高级光栅化平台 (WARP) 软件呈现器。 DirectX 11 呈现器在 DirectX 11 和 DirectX 10 GPU 上提供高性能、硬件加速呈现。 WARP 呈现器有助于确保资产适用于一系列计算机，其中包括没有新式图形硬件的计算机和具有集成图形硬件的计算机。有关 WARP 的详细信息，请参阅 [Windows 高级光栅化平台 (WARP) 指南](http://go.microsoft.com/fwlink/p/?LinkId=224634)。

## 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [使用纹理和图像](https://docs.microsoft.com/zh-cn/visualstudio/designers/working-with-textures-and-images?view=vs-2019) | 介绍如何使用 Visual Studio 处理图像和纹理。                  |
| [使用三维模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/working-with-3-d-models?view=vs-2019) | 介绍如何使用 Visual Studio 处理三维模型。                    |
| [使用着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/working-with-shaders?view=vs-2019) | 介绍如何使用 Visual Studio 着色器设计器创建和修改自定义着色器效果。 |
| [在游戏或应用中使用三维资产](https://docs.microsoft.com/zh-cn/visualstudio/designers/using-3-d-assets-in-your-game-or-app?view=vs-2019) | 介绍如何使用通过图像编辑器、模型编辑器或着色器设计器创建的游戏或应用中的资产。 |

## [Work with textures and images](https://docs.microsoft.com/en-us/visualstudio/designers/working-with-textures-and-images?view=vs-2019)

可以在 Visual Studio 中使用图像编辑器来创建和修改纹理与图像。 如同用 DirectX 应用程序开发的应用程序一样，图像编辑器支持丰富的纹理和图像格式。

Note

图像编辑器不支持低色彩图像，例如图标或光标。 若要创建或修改这种图像，请使用[图标的图像编辑器 (C++)](https://docs.microsoft.com/zh-cn/cpp/windows/image-editor-for-icons)。

### 纹理和图像

简单地说，纹理和图像只是用于在图形应用中提供可视细节的数据表。 纹理或图像提供的细节取决于其用法，颜色样本、Alpha（透明度）值、法线与高度值是常见的示例。 纹理与图像之间的主要差别在于，前者连同形状的表示形式（通常是三维模型）来呈现整个对象或场景，而图像通常是对象或场景的独立表示形式。

可以通过与纹理包含的数据类型或者与纹理维度或“形状”正交的方法来编码和压缩任何纹理。 但是，不同的编码和压缩方法可为不同类型的数据产生更好的效果。

你可以使用图像编辑器来创建和修改纹理和图像，就像使用其他图像编辑器一样。 图像编辑器还提供用于处理 3D 图形的 mipmap 及其他功能，并支持 DirectX 所支持的许多高度压缩与硬件加速的纹理格式。

纹理的常见类型包括：

#### 纹理图

纹理图包含已组织成一维、二维或三维矩阵的颜色值。 它们用于针对受影响的对象提供颜色细节。 颜色一般使用 RGB（红、绿、蓝）颜色通道来编码，可能包含表示透明度的第四个通道，即 Alpha。 较不常见的情况是，颜色可能以其他颜色方案来编码，或者第四个通道可能包含 Alpha 以外的数据，例如高度。

#### 法线图

法线图包含曲面法线。 它们用于针对受影响的对象提供照明细节。 法线通常使用红、绿、蓝分量进行编码，以存储向量的 x、y 和 z 维。 但是，还有其他编码 - 例如，基于极坐标的编码。

#### 高度图

高度图包含高度字段数据。 它们用于针对受影响的对象提供几何细节 - 使用着色器代码计算所需的效果 - 或者提供用例的数据点，例如地形生成。 高度值通常使用纹理中的一个通道进行编码。

#### 立方体图

立方体图可能包含不同类型的数据（例如，颜色或法线），但是已在立方体的表面组织成六个纹理。 因此，对立方体图进行采样的方式不是通过提供纹理坐标，而是提供原点在立方体中心的向量；样本是取自向量与立方体交集的点。 使用立方体图可以提供用于计算反射的环境近似值（称为 *环境映射*），或者提供失真度比基本、二维纹理低的纹理给球面对象。

### 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [图像编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019) | 介绍如何使用图像编辑器处理纹理和图像。                       |
| [图像编辑器示例](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor-examples?view=vs-2019) | 提供演示如何使用图像编辑器执行常见图像处理任务的主题的链接。 |

### [Image editor](https://docs.microsoft.com/en-us/visualstudio/designers/image-editor?view=vs-2019)

本文介绍如何使用 Visual Studio 图像编辑器查看和修改纹理及图像资源。

可使用图像编辑器来处理 DirectX 应用开发中使用的各种丰富的纹理和图像格式。 这包括支持常用图像文件格式和颜色编码、alpha 通道和 MIP 映射等功能，以及 DirectX 支持的许多高度压缩、硬件加速的纹理格式。

#### 支持的格式

图像编辑器支持以下图像格式：

| 格式名称            | 文件扩展名               |
| ------------------- | ------------------------ |
| 可迁移网络图形      | .png                     |
| JPEG                | .jpg、.jpeg、.jpe、.jfif |
| Direct Draw Surface | .dds                     |
| 可交换的图形格式    | .gif                     |
| Bitmap              | .bmp、.dib               |
| 标记图像文件格式    | .tif、.tiff              |
| TGA (Targa)         | .tga                     |

#### 入门

本部分介绍如何将图像添加到 Visual Studio 项目以及如何根据需要进行配置。

##### 将图像添加到项目

1. 在“解决方案资源管理器”中，打开要添加图像的项目的快捷菜单，然后选择“添加” > “新项”。

2. 在“添加新项”对话框中的“已安装”下，选择“图形”，然后为图像选择合适的文件格式。

   Note

   如果“添加新项”对话框中没有“图形”类别，则可能需要安装“图像和三维模型编辑器”组件。 关闭对话框，然后从菜单栏选择“工具” > “获取工具和功能”，以打开“Visual Studio 安装程序”。 选择“单个组件”选项卡，然后选择“游戏和图形”类别下的“图像和三维模型编辑器”组件。 选择“修改”。

   ![图像和三维模型编辑器组件](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/image-3d-model-editors-component.png?view=vs-2019)

   要了解如何根据需要选择文件格式，请参阅[选择图像格式](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019#choose-the-image-format)。

3. 指定图像文件的“名称”和所需的创建“位置”。

4. 选择 **“添加”** 按钮。

##### 选择图像格式

一些文件格式可能比其他格式更加适合，具体取决于准备如何使用图像。 例如，某些格式可能不支持所需功能，比如透明度或特定颜色格式。 某些格式可能无法为计划的图像内容提供适当的压缩率。

以下信息有助于选择符合要求的图像格式：

**位图图像 (.bmp)**

位图图像格式。 支持 24 位颜色的未压缩图像格式。 位图格式不支持透明度。

**GIF 图像 (.gif)**

图形交换格式 (GIF) 图像格式。 支持多达 256 种颜色的 LZW 压缩无损图像格式。 不适合颜色细节极多的照片和图像，但可为颜色一致性高的低色图像提供较好的压缩率。

**JPG 图像 (.jpg)**

联合图像专家组 (JPEG) 图像格式。 支持 24 位颜色的高压缩率有损图像格式，适合具有高度颜色一致性的图像的常规用途压缩。

**PNG 图像 (.png)**

可移植网络图形格式 (PNG) 图像格式。 支持 24 位颜色和 Alpha 透明度的中度压缩无损图像格式。 适合自然图像和人工图像，但其压缩率不如 JPG 或 GIF 等有损格式。

**TIFF 图像 (.tif)**

标记图像文件格式（TIFF 或 TIF）图像格式。 一种支持多种压缩方案的灵活图像格式。

**DDS 纹理 (.dds)**

DirectDraw Surface (DDS) 纹理格式。 支持 24 位颜色和 Alpha 透明度的高压缩率有损纹理格式。 其压缩率高达 8:1。 该格式基于 S3 纹理压缩，可在图形硬件上解压缩。

**TGA 图像 (.tga)**

Truevision Graphics Adapter (TGA) 图像格式（也称为 Targa）。 一种使用 RLE 算法的无损压缩图像格式，支持具有多达 24 位颜色和 Alpha 透明度的颜色映射（调色板）或直接颜色图像。 不适合颜色细节极多的照片和图像，但对大范围内颜色一致的图像可提供较好的压缩率。

##### 配置图像

在处理所创建的图像之前，可更改其默认配置。 例如，可更改图像使用的尺寸或颜色格式。 有关如何配置图像此类属性以及其他属性的信息，请参阅[图像属性](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019#image-properties)。

Note

保存工作前，如果要使用特定的颜色格式，请确保设置了“颜色格式”属性。 如果文件格式支持压缩，在首次保存文件或在选择“另存为”时可调整压缩设置。

#### 使用图像编辑器

本部分描述如何使用图像编辑器修改纹理和图像。

“图像编辑器模式”工具栏中提供影响图像编辑器状态的命令以及一些高级命令。 此工具栏位于图像编辑器设计图面的顶部边缘。 绘图工具位于图像编辑器设计图面最左侧边缘的“图像编辑器”工具栏中。

##### “图像编辑器模式”工具栏

![Visual Studio 中的“图像编辑器模式”工具栏](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-tre-modal-toolbar.png?view=vs-2019)

下表描述了“图像编辑器模式”工具栏上的项目，按其从左至右的显示顺序依次列出：

| 工具栏项                                                 | 说明                                                         |
| -------------------------------------------------------- | ------------------------------------------------------------ |
| **选择**                                                 | 可选择图像的矩形区域。 选择区域后，可执行剪切、复制、移动、缩放、旋转、翻转或删除操作。 若有可用的选择区域，绘图工具仅影响所选区域。 |
| **不规则选择**                                           | 可选择图像的不规则区域。 选择区域后，可执行剪切、复制、移动、缩放、旋转、翻转或删除操作。 若有可用的选择区域，绘图工具仅影响所选区域。 |
| **魔棒选择**                                             | 可选择图像中颜色相似的区域。 可配置容差（相邻颜色的最大差异，在此差异范围内，相邻颜色被视为相似）以选择颜色相似的较小或较大范围。 选择区域后，可执行剪切、复制、移动、缩放、旋转、翻转或删除操作。 若有可用的选择区域，绘图工具仅影响所选区域。 |
| **平移**                                                 | 可相对于窗口框架移动图像。 在“平移”模式下，选择图像上的点，然后进行移动。  可按住 Ctrl 来暂时激活“平移”模式。 |
| **缩放**                                                 | 可相对于窗口框架显示较多或较少的图像细节。 在“缩放”模式下，选择图像中的一个点，然后将其向右或向下移动进行放大，向左或向上移动进行缩小。  可在按住 Ctrl 的同时使用鼠标滚轮或按加号 (+) 或减号 (-) 进行放大或缩小。 |
| **缩放到实际大小**                                       | 使用图像像素和屏幕像素间 1:1 的比例关系显示图像。            |
| **缩放到合适大小**                                       | 在窗口框架中显示完整图像。                                   |
| **缩放到适合宽度**                                       | 在窗口框架中显示完整宽度的图像。                             |
| **网格**                                                 | 启用或禁用显示像素边界的网格。 缩放到图像之前，网格可能不会显示。 |
| **查看下一个 MIP 级别**                                  | 激活 MIP 映射链中的下一个更大 MIP 级别。 活动的 MIP 级别会显示在设计图面上。 此项仅适用于具有 MIP 级别的纹理。 |
| **查看上一个 MIP 级别**                                  | 激活 MIP 映射链中下一个更小的 MIP 级别。 活动的 MIP 级别会显示在设计图面上。 此项仅适用于具有 MIP 级别的纹理。 |
| **红色通道**  **绿色通道**  **蓝色通道**  **Alpha 通道** | 启用或禁用特定颜色通道。 **注意：** 通过系统地启用或禁用颜色通道，可隔离与其中一个或多个通道有关的问题。例如，可识别出不正确的 Alpha 透明度。 |
| **背景**                                                 | 启用或禁用通过图像的透明部分显示背景。 通过选择以下选项可配置背景的显示方式：  **棋盘** 将绿色和特定背景色结合使用，以棋盘图案显示背景。 可使用此选项让图像透明部分变得更加明显。  白色背景 使用白色来显示背景。  黑色背景 使用黑色来显示背景。  动画背景 缓慢平移棋盘图案。 可使用此选项让图像透明部分变得更加明显。 |
| **属性**                                                 | 交替打开或关闭“属性”窗口。                                   |
| **高级**                                                 | 包含其他命令和选项。  **筛选器**  提供了几个常见的图像筛选器：“黑白”、“模糊”、“亮化”、“暗化”、“边检测”、“浮雕”、“反色”、“波纹”、“棕色调”和“锐化”。  **图形引擎**  **用 D3D11 呈现** 使用 Direct3D 11 呈现图像编辑器设计图面。  **用 D3D11WARP 呈现** 使用 Direct3D 11 Windows 高级光栅化平台 (WARP) 呈现图像编辑器设计图面。  **工具**  **水平翻转** 围绕水平或 x 轴转置图像。  **垂直翻转** 围绕垂直或 y 轴转置图像。  **生成 Mip** 生成图像的 MIP 级别。 如果已经存在 MIP 级别，则会从最大 MIP 级别重新创建。 对较小 MIP 级别所作的任何更改都会丢失。 若要保存已生成的 MIP 级别，必须使用 .dds 格式来保存图像。  **视图**  **帧速率** 启用时，会在设计图面的右上角显示帧速率。 帧速率为每秒绘制的帧数。 **提示：** 可以选择“高级”按钮再次运行上一个命令。 |

##### “图像编辑器”工具栏

![“图像编辑器”工具栏](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-tre-toolbar.png?view=vs-2019)

下表描述了“图像编辑器”工具栏上的项目，按其从上到下的显示顺序依次列出：

| 工具栏项                                   | 说明                                                         |
| ------------------------------------------ | ------------------------------------------------------------ |
| **铅笔**                                   | 使用处于活动状态的颜色选择绘制锯齿笔划。 可在“属性”窗口中设置笔划颜色和粗细。 |
| **画笔**                                   | 使用处于活动状态的颜色选择绘制抗锯齿笔划。 可在“属性”窗口中设置笔划颜色和粗细。 |
| **喷枪**                                   | 使用处于活动状态的颜色选择绘制抗锯齿笔划，此抗锯齿笔划与图像混合，随时间变化变得越饱和。 可在“属性”窗口中设置笔划颜色和粗细。 |
| **取色器**                                 | 将处于活动状态的颜色选择设置为选择的像素的颜色。             |
| **填充**                                   | 使用处于活动状态的颜色选择填充图像区域。 受影响区域和相同颜色像素及此相同颜色本身像素连接的每个像素会定义为在其中应用填充的像素。 如果填充应用于处于活动状态的选择区域，则受影响区域受选择区域限制。  默认情况下，处于活动状态的颜色选择区域根据其 Alpha 组件，与图像受影响区域相混合。 若要使用活动颜色选择覆盖受影响区域，请在使用填充工具时按住 Shift 键。 |
| **橡皮擦**                                 | 如果图像支持 alpha 通道，则将像素设置为完全透明色。 否则，将像素设置为活动背景色。 |
| **线**、**矩形**、**圆角矩形**、**椭圆形** | 在图像上绘制形状。 可在“属性”窗口中设置边框颜色和粗细。  若要绘制一个宽度和高度相等的基元，请在绘制时按住 Shift 键。 |
| **文本**                                   | 使用前景色选择绘制文本。 背景色由背景色选择所决定。 对于透明背景，背景色选择的 Alpha 值必须为 0。 文本区域处于活动状态时，可在“属性”窗口中设置是否使用抗锯齿笔划绘制文本，还可设置文本的**值**、**字体**、**字号**和样式（**加粗**、**斜体**或**下划线**）。 文本区域不再处于活动状态时会最终确定文本的内容和外观。 |
| **旋转**                                   | 将图像顺时针旋转 90 度。                                     |
| **剪裁**                                   | 将图像剪裁为处于活动状态的选择区域。                         |

##### 使用 MIP 级别

DirectDraw Surface (.dds) 等部分图像格式支持对纹理空间细节级别 (LOD) 使用 MIP 级别。 有关如何生成和使用 MIP 级别的信息，请参阅[如何：创建和修改 MIP 级别](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-and-modify-mip-levels?view=vs-2019)

##### 使用透明度效果

DirectDraw Surface (.dds) 等部分图像格式支持透明度效果。 使用透明度效果的方式有几种，具体取决于所使用的工具。 若要为颜色选择指定透明度级别，可在“属性”窗口中设置颜色选择的 **A** (alpha) 组件。

下表描述了不同类型的工具如何控制透明度的应用方式：

| 工具                                                         | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| **铅笔**、**画笔**、**喷枪**、**线**、**矩形**、**圆角矩形**、**椭圆形**、**文本** | 若要将活动颜色选择与图像混合，在“属性”窗口中，展开“通道”属性组，选中“Alpha”通道上的“绘制”复选框，然后正常绘制即可。  若要使用活动颜色选择进行绘制并保留图像的 Alpha 值，可取消选中“Alpha”通道的“绘制”复选框，然后正常绘制即可。 |
| **填充**                                                     | 若要将活动颜色选择与图像混合，只需选择要填充的区域即可。  若要使用活动颜色选择（包括 alpha 通道的值）来覆盖图像，请按住 Shift，然后选择要填充的区域。 |

##### 图像属性

可使用“属性”窗口指定图像的多种属性。 例如，可设置宽度和高度属性来调整图像的大小。

下表对图像属性进行了描述：

| Property     | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| 宽度         | 图像的宽度。                                                 |
| 高度         | 图像的高度。                                                 |
| 每像素位数   | 表示每个像素的位数。 此属性的值取决于图像的**颜色格式**。    |
| 透明选择     | 若要基于选择层的 Alpha 值将选择层与主图像混合，则为 **True**；否则为 **False**。 此项仅适用于支持 Alpha 的图像。 |
| 格式         | 图像的颜色格式。 可以指定不同的颜色格式，具体取决于图像格式。 颜色格式定义图像中包含的颜色通道的数量和类型以及不同通道的大小和编码。 |
| Mip 级别     | 活动 MIP 级别。 此项仅适用于具有 MIP 级别的纹理。            |
| Mip 级别计数 | 图像中 MIP 级别的总数。 此项仅适用于具有 MIP 级别的纹理。    |
| 帧数         | 图像中帧的总数。 此项仅对支持纹理数组的图像可用。            |
| Frame        | 当前的帧。 仅可查看第一个帧；保存图像时会丢失所有其他帧。    |
| 深度切片计数 | 图像中深度切片的总数。 此项仅对支持体积纹理的图像可用。      |
| 深度切片     | 当前深度切片。 仅可查看第一个切片；保存图像时会丢失所有其他切片。 |

Note

由于“旋转角度”属性适用于所有工具和选择区域，因此它和其他工具属性始终显示在“属性”窗口的底部。 由于无其他选择或活动工具时会隐式选中整个图像，因此会始终显示“旋转角度”。 有关“旋转角度”属性的详细信息，请参阅[工具属性](#tool -properties)。

##### 调整图像大小

以下是调整图像大小的两种方式。 在这两种情况下，图像编辑器均使用双线性内插来对图像重新取样。

- 在“属性”窗口中，为“宽度”和“高度”属性指定新的值。
- 选择整个图像，然后使用边框标记调整图像的大小。

##### 选择区域

图像编辑器中的所选项定义了活动图像的区域。 活动区域受工具和转换的影响。 存在活动选择区域时，选择区域之外的区域不会受大多数工具和转换的影响。 如果不存在活动选择区域，则整个图像处于活动状态。

大多数工具（铅笔、画笔、喷枪、填充、橡皮擦和二维基元）以及转换（旋转、剪裁、反色、水平翻转和垂直翻转）受活动选择区域限制或定义。 但是，某些工具（取色器和文本）和转换（生成 Mip）不受任何活动选择的影响。 这些工具始终表现为如同整个图像处于活动选择区域一样。

选择区域时，可按住 Shift 来选择成比例的（方形）区域。 否则，选择区域不受限制。

###### 调整选定内容大小

选择区域后，可通过更改选择区域标记的大小来重新调整选择区域或其图像内容的大小。 调整选择区域大小时，可在调整大小的同时使用以下修改键来更改所选区域的行为：

**Ctrl** - 在调整大小前复制所选区域的内容。 从而调整副本大小，但保留原始图像。

**Shift** - 基于原始大小按比例调整所选区域的大小。

**Alt** - 更改所选区域的大小。 这不会修改图像。

下表描述了修改键的有效组合：

| Ctrl     | 移位      | Alt     | 说明                                              |
| -------- | --------- | ------- | ------------------------------------------------- |
|          |           |         | 调整所选区域内容的大小。                          |
|          | **Shift** |         | 按比例调整所选区域内容的大小。                    |
|          |           | **Alt** | 调整所选区域的大小。 这会定义新的选择区域。       |
|          | **Shift** | **Alt** | 按比例调整所选区域的大小。 这会定义新的选择区域。 |
| **Ctrl** |           |         | 复制并调整所选区域内容的大小。                    |
| **Ctrl** | **Shift** |         | 复制并按比例调整所选区域内容的大小。              |

##### 工具属性

选择工具时，可使用“属性”窗口指定有关工具如何影响图片的详细信息。 例如，可设置“铅笔”工具的粗细或“画笔”工具的颜色。

可同时设置前景色和背景色。 两者都支持 alpha 通道来提供用户定义的不透明度。 这些设置适用于所有工具。 如果使用鼠标，则鼠标左键对应前景色，鼠标右键对应背景色。

下表对工具属性进行了描述：

| 工具                                       | 属性                                                         |
| ------------------------------------------ | ------------------------------------------------------------ |
| 所有工具和选择                             | **旋转角度** 定义选择区域或工具效果按顺时针方向旋转的角度（以度为单位）。 |
| **铅笔**、**画笔**、**喷枪**、**橡皮擦**   | **粗细** 定义工具有效作用区域的大小。                        |
| **文本**                                   | **抗锯齿** 绘制具有抗锯齿边缘的文本。 这会使文本外观更流畅。  **值** 要绘制的文本。  **字体** 用于绘制文本的字体。  **Size** 文本大小。  **加粗** 使字体加粗。  **斜体** 使字体变为斜体。  **下划线** 使字体带下划线。 |
| **二维基元**                               | **抗锯齿** 绘制具有抗锯齿边缘的基元。 这会使基元外观更流畅。  **粗细** 定义构成基元边界的线的粗细。  **半径 X** （仅限圆角矩形）定义基元上下边缘的圆角半径。  **半径 Y** （仅限圆角矩形）定义基元左右边缘的圆角半径。 |
| **铅笔**、**画笔**、**喷枪**、**二维基元** | **通道** 为查看和绘制启用或禁用特定颜色通道。 如果“查看”设置了特定颜色通道，则该通道在图像中可见；否则为不可见。 如果“绘制”设置了特定颜色通道，则该通道受绘制操作影响；否则不受影响。 |
| **魔棒选择**、**填充**                     | **容差** 定义相邻颜色被视为相似的最大差异，从而使更多或更少相似颜色成为受影响区域或选择区域的一部分。 默认情况下，值为 32，这意味着原始颜色的 32 种色度（颜色更淡或更浓）之内的相邻像素会被视为该区域的一部分。 |

#### 键盘快捷键

| 命令                                       | 键盘快捷键                                           |
| ------------------------------------------ | ---------------------------------------------------- |
| 切换到“选择”模式                           | **S**                                                |
| 切换到“缩放”模式                           | **Z**                                                |
| 切换到“平移”模式                           | **K**                                                |
| 全选                                       | Ctrl+A                                               |
| 删除当前选定内容                           | **删除**                                             |
| 取消当前选择                               | Esc（Esc 键）                                        |
| 放大                                       | Ctrl+向前滚动鼠标滚轮  Ctrl+PgUp  加号 (+)           |
| 缩小                                       | Ctrl-向后滚动鼠标滚轮  Ctrl-PgDn  减号 (-)           |
| 向上平移图像                               | 向后滚动鼠标滚轮  PgDn                               |
| 向下平移图像                               | 向前滚动鼠标滚轮  PgUp                               |
| 向左平移图像                               | Shift+向后滚动鼠标滚轮  向左滚动鼠标滚轮  Shift+PgDn |
| 向右平移图像                               | Shift+向前滚动鼠标滚轮  向右滚动鼠标滚轮  Shift+PgUp |
| 缩放到实际大小                             | Ctrl + 0（零）                                       |
| 根据窗口调整图像大小                       | Ctrl+G，Ctrl+F                                       |
| 将图像调整到窗口宽度                       | Ctrl+G，Ctrl+I                                       |
| 切换网格                                   | Ctrl+G，Ctrl+G                                       |
| 将图像剪切到当前选择区域                   | Ctrl+G，Ctrl+C                                       |
| 查看下一（更高细节）MIP 级别               | Ctrl+G，Ctrl+6                                       |
| 查看上一（更低细节）MIP 级别               | Ctrl+G，Ctrl+7                                       |
| 切换红色颜色通道                           | Ctrl+G，Ctrl+1                                       |
| 切换绿色颜色通道                           | Ctrl+G，Ctrl+2                                       |
| 切换蓝色颜色通道                           | Ctrl+G，Ctrl+3                                       |
| 切换 Alpha（透明度）通道                   | Ctrl+G，Ctrl+4                                       |
| 切换 Alpha 棋盘图案                        | Ctrl+G，Ctrl+B                                       |
| 切换到不规则选择工具                       | **L**                                                |
| 切换到魔棒选择工具                         | **M**                                                |
| 切换到铅笔工具                             | **P**                                                |
| 切换到画笔工具                             | **B**                                                |
| 切换到填充工具                             | **F**                                                |
| 切换到橡皮擦工具                           | **E**                                                |
| 切换到文本工具                             | **T**                                                |
| 切换到颜色选择（取色器）工具               | **I**                                                |
| 移动活动选择区域及其内容。                 | 箭头键。                                             |
| 调整活动选择区域及其内容的大小。           | Ctrl+箭头键                                          |
| 移动活动选择区域，但不移动其内容。         | Shift+箭头键                                         |
| 调整活动选择区域大小，但不调整其内容大小。 | Shift+Ctrl+箭头键                                    |
| 提交当前层                                 | **Return**                                           |
| 降低工具粗度                               | **[**                                                |
| 增加工具粗度                               | **]**                                                |

#### 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [处理游戏和应用的三维资产](https://docs.microsoft.com/zh-cn/visualstudio/designers/working-with-3-d-assets-for-games-and-apps?view=vs-2019) | 概述 Visual Studio 中可用于处理图形资产（例如纹理和图像、三维模型和着色器效果）的工具。 |
| [模型编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/model-editor?view=vs-2019) | 描述如何使用 Visual Studio 模型编辑器处理三维模型。          |
| [着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019) | 描述如何使用 Visual Studio 着色器设计器处理着色器。          |

### [Image editor examples](https://docs.microsoft.com/en-us/visualstudio/designers/image-editor-examples?view=vs-2019)

本节文档中的文章包含演示如何使用图像编辑器的示例。

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [如何：创建基本纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-texture?view=vs-2019) | 演示如何创建基本纹理。                                       |
| [如何：创建和修改 MIP 级别](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-and-modify-mip-levels?view=vs-2019) | 演示如何从图像生成 MIP 级别。                                |
| [在游戏或应用中使用三维资产](https://docs.microsoft.com/zh-cn/visualstudio/designers/using-3-d-assets-in-your-game-or-app?view=vs-2019) | 介绍如何在构建项目或解决方案时使用 Visual Studio 处理三维资产，以便在应用中随时使用它们。 此外，还讨论了将不同种类的资产加载到应用中的其他策略。 |
| [如何：导出包含 mipmap 的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-texture-that-contains-mipmaps?view=vs-2019) | 描述如何使用“图像内容管道”导出包含预计算 mipmap 的纹理。     |
| [如何：导出包含预乘 Alpha 的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-texture-that-has-premultiplied-alpha?view=vs-2019) | 描述如何使用“图像内容管道”导出包含预乘 alpha 值的纹理。      |
| [如何：导出纹理以用于 Direct2D 或 Javascipt 应用](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-texture-for-use-with-direct2d-or-javascipt-apps?view=vs-2019) | 描述如何使用图像内容管道导出可在 Direct2D 或 Javascript 应用中使用的纹理。 |

#### [Create a basic texture](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-a-basic-texture?view=vs-2019)

本文演示如何使用图像编辑器创建基本纹理，包括以下活动：

- 设置纹理的大小
- 设置前景色和背景色
- 使用 alpha 通道（透明度）
- 使用“填充”和“椭圆形”工具
- 设置工具属性

##### 创建基本纹理

可使用图像编辑器创建和修改游戏或应用的图像和纹理。

以下步骤说明如何创建表示“靶心”目标的纹理。 完成后，纹理应如下图所示。 为了更好地演示纹理中的透明度，已将图像编辑器配置为使用绿色的方格棋盘图案来显示它。

![显示为绿色的透明“靶心”目标](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-bullseye-texture-in-editor.png?view=vs-2019)

开始前，请确保显示“属性”窗口”。 在工作时，可以使用“属性”窗口设置图像的大小、更改工具属性以及指定颜色。

###### 创建“靶心”目标纹理

1. 创建要处理的纹理。 有关如何向项目添加纹理的信息，请参阅[图像编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019#get-started)。

2. 将图像大小设置为 512x512 像素。 在“属性”窗口中，将“宽度”和“高度”属性的值设置为 `512`。

3. 在“图像编辑器”工具栏上，选择“填充”工具。 “属性”窗口现在显示“填充”工具的属性以及图像属性。

4. 将前景色设置为完全透明的黑色。 在“属性”窗口的“颜色”属性组中，选择“前景色”。 将颜色选取器旁边的“R”、“G”、“B”和“A”属性的值设置为 `0`。

5. 在“图像编辑器”工具栏上，选择“填充”工具，然后按住 Shift 键并选择图像中的任意点。 使用 Shift 键让填充颜色的 Alpha 值替换图像中的颜色；否则，Alpha 值将用于将填充颜色与图像中的颜色进行混合。

   Important

   此步骤和上一步中的颜色选择一起确保为要绘制的“靶心”目标纹理准备好了基本图像。 当用透明黑色填充图像时（因为目标的边框是黑色的），目标周围将没有混叠的项。

6. 在“图像编辑器”工具栏上，选择“椭圆形”工具。

7. 将前景色设置为完全不透明的黑色。 将“R”、“G”和“B” 属性的值设置为 `0`，将“A”属性的值设置为 `255`。

8. 将背景色设置为完全不透明的白色。 在“属性”窗口的“颜色”属性组中，选择“背景”。 将 **R**、**G**、**B** 和 **A** 属性的值设置为 `255`。

9. 设置椭圆形边框的宽度。 在“属性”窗口的“外观”属性组中，将“宽度”属性的值设置为 `8`。

10. 确保已启用抗锯齿。 在“属性”窗口的“外观”属性组中，确保设置了“抗锯齿”属性。

11. 使用“椭圆形”工具，从像素坐标 `(3, 3)` 到像素坐标 `(508, 508)` 绘制一个圆。 为了更轻松地绘制圆形，可以在绘制时按住 Shift 键。

    Note

    当前指针位置的像素坐标显示在 Visual Studio 状态栏上。

12. 更改背景色。 将“R”设置为 `44`、将“G” 设置为 `165`、将“B” 设置为 `211`、将“A” 设置为 `255`。

13. 从像素坐标 `(64, 64)` 到像素坐标 `(448, 448)` 绘制另一个圆。

14. 将背景色更改回完全不透明的白色。 将“R”、“G”、“B”和“A”设置为 `255`。

15. 从像素坐标 `(128, 128)` 到像素坐标 `(384, 384)` 绘制另一个圆。

16. 更改背景色。 将“R”设置为 `255`、将“G” 和“B” 设置为 `64`，并将“A” 设置为 `255`。

17. 从像素坐标 `(192, 192)` 到像素坐标 `(320, 320)` 绘制另一个圆。

“靶心”目标纹理是完整的。 下面是最终图像（以透明度显示）。

![完整的“靶心”目标纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_image_demo_bullseye.png?view=vs-2019)

作为下一步，可以为此纹理生成 MIP 级别。 有关详细信息，请参阅[如何：创建和修改 MIP 级别](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-and-modify-mip-levels?view=vs-2019)。

#### [Create and modify MIP levels](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-and-modify-mip-levels?view=vs-2019)

本文档演示如何使用“图像编辑器”生成并修改纹理空间详细级别 (LoD) 的 MIP 级别。

##### 生成 MIP 级别

*Mipmapping* 是一种技术，用于通过预先计算并以不同大小存储纹理的多个副本来提高呈现速度并减少纹理对象上的混叠项。 每个副本（称为 MIP 级别）的宽度和高度均为前一副本的一半。 当在对象的表面上呈现纹理时，将自动选择与纹理表面的屏幕空间区域对应最为紧密的 MIP 级别。 这意味着图形硬件不必筛选尺寸过大的纹理来维持一致的视觉质量。 尽管存储 MIP 级别的内存开销比存储单独的原始纹理的内存开销要高大约 33%，但随之而来的是性能和图像质量上的提升。

###### 生成 MIP 级别

1. 如[如何：创建基本纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-texture?view=vs-2019)中所述，从基本纹理开始。 为了获得最佳结果，请指定宽度和高度为 2 的幂（例如，256、512、1024 等）的纹理。

2. 生成 MIP 级别。 在“图像编辑器模式”工具栏上，依次选择“高级” > “工具” > “生成 Mip”。

   请注意，“转到下一 Mip 级别”和“转到上一 Mip 级别”按钮现在将出现在“图像编辑器模式”工具栏上。 如果显示“属性”窗口，则还可以注意到，只读属性“Mip 级别”和“Mip 级别计数”现在将出现在图像属性中。

##### 修改 MIP 级别

若要实现特殊效果或在特定的详细级别提高图像质量，可以单独修改每个 MIP 级别。 例如，可以在某一距离（对应于更小的 MIP 级别更远的距离）为纹理对象提供不同的外观，或者可以确保即使处于较小的 MIP 级别，包含文本或符号的纹理仍保持清晰。

###### 修改单个 MIP 级别

1. 选择想要修改的 MIP 级别。 在“图像编辑器模式”工具栏上，使用“转到下一 MIP 级别”和“转到上一 MIP 级别”按钮在 MIP 级别之间进行选择。
2. 选择想要修改的 MIP 级别后，可以使用绘图工具对其进行修改，而不会更改其他 MIP 级别的内容。 “图像编辑器”工具栏上提供了绘图工具。 选择工具后，可以在“属性”窗口中更改其属性。 有关绘图工具及其属性的信息，请参阅[图像编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019)。

> 如果无需修改单个 MIP 级别的内容（可能会执行此操作以实现某些效果），建议在生成时从源纹理生成 mipmap。 这有助于确保 MIP 级别与源纹理保持同步，因为对某一 MIP 级别的修改不会自动传播到其他级别。 有关如何在生成时生成 mipmap 的详细信息，请参阅[如何：导出包含 Mipmap 的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-texture-that-contains-mipmaps?view=vs-2019)。

## [Work with 3D models](https://docs.microsoft.com/en-us/visualstudio/designers/working-with-3-d-models?view=vs-2019)

可以使用 Visual Studio 中的模型编辑器来创建三维模型。 可以在基于 DirectX 的游戏或应用中使用该模型。

### 三维模型

当对象存在于三维场景中时，三维模型用于定义对象的形状。 模型可以是基本孤立对象、形成自基本对象层次结构的复杂对象，甚或是整个三维场景。 三维对象由三维空间中的点（称为顶点）构成，用于定义三角形、线或其他由这些点组成的基元的指标，以及可能应用于每个顶点或每个基元的特性，如曲面法线。 此外，一些信息可能会按对象进行应用，例如，哪一个着色器和纹理会为对象提供唯一外观。

模型编辑器是创建基本三维模型时所需的唯一工具（辅以材料属性、纹理和像素着色器），可在游戏或应用中使用这些基本模型。 或可创建占位符模型，在艺术家完成模型之前用于原型制作和测试。

也可以使用模型编辑器查看使用功能完善的工具创建的现有三维模型，以及在艺术资产中发现问题时对这些模型进行修改。

### 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [模型编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/model-editor?view=vs-2019) | 描述如何使用模型编辑器处理三维模型。                         |
| [模型编辑器示例](https://docs.microsoft.com/zh-cn/visualstudio/designers/model-editor-examples?view=vs-2019) | 提供演示如何使用模型编辑器执行常见三维模型任务的主题的链接。 |

### [Model editor](https://docs.microsoft.com/en-us/visualstudio/designers/model-editor?view=vs-2019)

本文档介绍如何使用 Visual Studio 模型编辑器查看、创建和修改三维模型。

可以使用模型编辑器从头开始创建基本的三维模型，或查看和修改使用全功能三维建模工具创建的更为复杂的三维模型。

#### 支持的格式

模型编辑器支持用于 DirectX 应用程序开发的若干三维模型格式。

| 格式名称              | 文件扩展名 | 支持的操作（查看、编辑、创建）                               |
| --------------------- | ---------- | ------------------------------------------------------------ |
| Autodesk FBX 交换文件 | .fbx       | 查看、编辑、创建                                             |
| Collada DAE 文件      | .dae       | 查看、编辑（通过使用 FBX 格式保存对 Collada DAE 文件的修改）。 |
| OBJ                   | .obj       | 查看、编辑（通过使用 FBX 格式保存对 OBJ 文件的修改）。       |

#### 入门

本节描述如何将 3D 模型添加到 Visual Studio C++ 项目和可帮助你入门的基本信息。

Note

图像项（例如 3D 场景 [.fbx 文件]）的自动生成集成仅支持 C++ 项目。

##### 向你的项目添加三维模型

1. 确保你已安装使用图形所需的必备 Visual Studio 组件。 组件称为图像和三维模型编辑器。

   若要安装它，通过从菜单栏中选择“工具” > “获取工具和功能”打开 Visual Studio 安装程序，然后选择“单个组件”选项卡。选择“游戏和图形”类别下的“图像和三维模型编辑器”组件，然后选择“修改”。

   ![图像和三维模型编辑器组件](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/image-3d-model-editors-component.png?view=vs-2019)

   组件启动安装。

2. 在“解决方案资源管理器”中，打开图像要添加到的 C++ 项目的快捷菜单，然后选择“添加” > “新建项目”。

3. 在“添加新项”对话框中的“图形”类别下，选择“3D 场景(.fbx)”。

   ![“添加新项”对话框（已选择 3D 场景）](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/add-new-3d-scene.png?view=vs-2019)

   Note

   如果没有看到“添加新项”对话框中的“图形”类别，且你已安装“图像和三维模型编辑器”组件，则图形项不支持你的项目类型。

4. 输入模型文件的名称，然后选择“添加”。

##### 轴方向

Visual Studio 支持三维轴的每个方向，并从支持它的模型文件格式中加载轴方向信息。 如果未指定轴方向，则 Visual Studio 默认使用右手坐标系。 “轴指示器”在设计图面右下角显示当前轴方向。 在“轴指示器”上，红色表示 x 轴，绿色表示 y 轴，蓝色表示 z 轴。

##### 开始编辑三维模型

在模型编辑器中，每个新对象最初都是一个内置到模型编辑器中的基本三维形状，或称为“基元”。 若要创建新的唯一对象，先将基元添加到场景中，然后通过修改其顶点更改形状。 对于复杂形状，先使用延伸或细分添加更多顶点，然后修改它们。 有关如何向场景中添加基元对象的信息，请参阅[创建和导入三维对象](https://docs.microsoft.com/zh-cn/visualstudio/designers/model-editor?view=vs-2019#Adding3DObjects)。 有关如何向对象添加更多顶点的信息，请参阅[修改对象](https://docs.microsoft.com/zh-cn/visualstudio/designers/model-editor?view=vs-2019#ModifyingObjects)。

#### 使用模型编辑器

以下各节描述如何使用模型编辑器处理三维模型。

##### 模型编辑器工具栏

模型编辑器工具栏包含有助于处理三维模型的命令。

影响模型编辑器状态的命令位于 Visual Studio 主窗口的“模型编辑器模式”工具栏上。 建模工具和脚本命令位于模型编辑器设计图面中的“模型编辑器”工具栏上。

以下是“模型编辑器模式”工具栏：

![模型查看器模式工具栏。](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-mre-modal-toolbar.png?view=vs-2019)

下表描述“模型编辑器模式”工具栏上的项目，按其从左至右的显示顺序列出。

| 工具栏项         | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **选择**         | 基于活动的选择模式，选择场景中的点、边、面或对象。           |
| **平移**         | 相对于窗口框架移动三维场景。 若要进行平移，请选择场景中的一个点，然后将其四处移动。  在“选择”模式下，可以按住 Ctrl 来暂时激活“平移”模式。 |
| **缩放**         | 相对于窗口框架显示较多或较少的场景详细信息。 在“缩放”模式下，选择场景中的一个点，然后将其向右或向下移动可放大，向左或向上移动可缩小。  在“选择”模式下，可以在按住 Ctrl 的同时使用鼠标滚轮来放大或缩小。 |
| 轨迹             | 将视图定位在围绕选定对象的圆形路径上。 如果未选中对象，则路径以场景原点为中心。 **注意：** 启用“正交”投影时，此模式不起作用。 |
| 世界本地         | 启用此项时，对选定对象的转换将在世界空间中进行。 否则，对选定对象的转换将在本地空间中进行。 |
| 透视模式         | 启用此项时，转换会影响选定对象的中心点的位置和方向（中心点定义平移、缩放和旋转操作的中心）。否则，转换将影响对象的几何图形相对于中心点的位置和方向。 |
| 锁定 X 轴        | 将对象操纵限制到 x 轴。 仅当你使用操控器小组件的中心部分时应用。 |
| 锁定 Y 轴        | 将对象操纵限制到 y 轴。 仅当你使用操控器小组件的中心部分时应用。 |
| 锁定 Z 轴        | 将对象操纵限制到 z 轴。 仅当你使用操控器小组件的中心部分时应用。 |
| 框选对象         | 框选选定的对象，以使之位于视图的中心。                       |
| **视图**         | 设置视图方向。 以下是可用方向：  正面 将视图定位在场景的正面。  **后退** 将视图定位在场景的背面。  左侧 将视图定位在场景的左侧。  右侧 将视图定位在场景的右侧。  顶部 将视图定位在场景的顶面。  底部 将视图定位在场景的底面。 **注意：** 这是在启用“正交”投影时更改视图方向的唯一方法。 |
| **投影**         | 设置用于绘制场景的投影类型。 以下是可用的投影：  透视 在透视投影中，远离视点的对象看起来较小，并最终在远处会聚为一个点。  正交 在正交投影中，不管对象与视点间的距离如何，对象的大小看上去是相同的。 不显示会聚现象。 启用“正交”投影时，不能使用“轨迹”模式来定位视图。 |
| 绘制样式         | 设置对象在场景中的呈现方式。 以下是可用的样式：  透明框架 启用时，对象呈现为透明框架。  过度绘制 启用时，通过使用附加混合呈现对象。 使用此工具可以直观显示场景中的过度绘制程度。  平面着色 启用时，通过使用基本的平面着色照明模型呈现对象。 使用此工具可以更轻松地看到对象的各个面。  如果这些选项都没启用，则使用应用于自身的材料呈现每个对象。 |
| **实时呈现模式** | 启用实时呈现时，即使没有执行用户操作，Visual Studio 也将重绘设计图面。 此模式用于处理随时间变化的着色器。 |
| 切换网格         | 启用此项时，将显示网格。 否则，不显式网格。                  |
| **工具箱**       | 交替显示或隐藏“工具箱”。                                     |
| **文档大纲**     | 交替显示或隐藏“文档大纲”窗口。                               |
| **属性**         | 交替显示或隐藏“属性”窗口。                                   |
| **高级**         | 包含高级命令和选项。  **图形引擎**  **用 D3D11 呈现** 使用 Direct3D 11 呈现模型编辑器设计图面。  **用 D3D11WARP 呈现** 使用 Direct3D 11 Windows 高级光栅化平台 (WARP) 呈现模型编辑器设计图面。  场景管理  **Import** 从另一个三维模型文件向当前场景导入对象。  附加到父级 将多个选定对象中的第一个设为剩余选定对象的父级。  从父级分离 从父级分离选定的对象。 选定对象将成为场景中的根对象。 根对象没有父对象。  创建组 将选定的对象编组为同级对象。  合并对象 将选定的多个对象合并为一个对象。  从多边形选择创建新的对象 从当前对象中删除选定面并将包含这些面的新对象添加到场景中。  **工具**  翻转多边形绕组 翻转选定的多边形，使其绕组序列和图面法向反转。  移除所有动画 移除对象中的动画数据。  三角化 将选定对象转换为三角形。  **视图**  隐面消除 启用或禁用隐面消除。  **帧速率** 在设计图面的右上角显示帧速率。 帧速率为每秒绘制的帧数。  在启用“实时呈现模式”选项时，此选项才有用。  全部显示 显示场景中的所有对象。 此选项将每个对象的“隐藏”属性重置为“False”。  显示面法向 显示每个面的法向。  显示缺失材料 在没有指派材料的对象上显示特殊纹理。  显示中心点 显示或隐藏活动选择项的透视点上的三维轴标记。  显示占位符节点 显示占位符节点。 为对象分组时将创建占位符节点。  显示顶点法向 显示每个顶点的法向。 **提示：** 可选择“脚本”按钮再次运行上一个脚本。 |

以下是“模型编辑器”工具栏：

![模型查看器工具栏](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-mre-toolbar.png?view=vs-2019)

下表描述“模型编辑器”工具栏上的项目，按其从上到下的显示顺序列出。

| 工具栏项 | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| 平移     | 移动选定对象。                                               |
| 缩放     | 更改选定对象的大小。                                         |
| **旋转** | 旋转选定对象。                                               |
| 选择点   | 将“选择模式”设置为选择对象上的各个点。                       |
| 选择边   | 将“选择模式”设置为选择对象上的一个边（两个顶点间的一条线）。 |
| 选择面   | 将“选择模式”设置为选择对象上的一个面。                       |
| 选择对象 | 将“选择模式”设置为选择整个对象。                             |
| 延伸     | 创建其他面并将其连接到选定的面。                             |
| 细分     | 将每个选定的面划分为多个面。 若要创建新面，需添加新顶点（原始面中心的一个点，每条边中间的一个点），然后将其与原始顶点结合起来。 添加的面数与原始面中的边数相等。 |

##### 控制视图

三维场景基于视图呈现，该视图可视为具有位置和方向的虚拟照相机。 要更改位置和方向，请使用“模型编辑器模式”工具栏上的视图控件。

下表描述主要视图控件。

| 视图控件 | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| **平移** | 相对于窗口框架移动三维场景。 若要进行平移，请选择场景中的一个点，然后将其四处移动。  在“选择”模式下，可以按住 Ctrl 来暂时激活“平移”模式。 |
| **缩放** | 相对于窗口框架显示较多或较少的场景详细信息。 在“缩放”模式下，选择场景中的一个点，然后将其向右或向下移动可放大，向左或向上移动可缩小。  在“选择”模式下，可以在按住 Ctrl 的同时使用鼠标滚轮来放大或缩小。 |
| 轨迹     | 将视图定位在围绕选定对象的圆形路径上。 如果未选中对象，则路径以场景原点为中心。 **注意：** 启用“正交”投影时，此模式不起作用。 |
| 框选对象 | 框选选定的对象，以使之位于视图的中心。                       |

视图由虚拟照相机建立，但也由投影定义。 投影将定义视图中的形状和对象如何转换为设计图面上的像素。 在“模型编辑器”工具栏上，可以选择“透视”或“正交”投影。

| 投影 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| 透视 | 在透视投影中，远离视点的对象看起来较小，并最终在远处会聚为一个点。 |
| 正交 | 在正交投影中，不管对象与视点间的距离如何，对象的大小看上去是相同的。 不显示会聚现象。 启用“正交”投影时，不能使用“轨迹”模式来随意定位视图。 |

可能会发现从已知位置和角度查看三维场景很有用处，例如，希望比较两个相似的场景时。 对于此情形，模型编辑器提供了若干预定义的视图。 要使用预定义的视图，请在“模型编辑器模式”工具栏上，选择“视图”，然后选择所需的预定义视图 - 正面、背面、左侧、右侧、顶部或底部。 在这些视图中，虚拟照相机直视场景的原点。 例如，选择“查看顶部”时，虚拟照相机直接从场景上方查看其原点。

##### 查看其他几何详细信息

为更好地了解三维对象或场景，可以查看其他几何详细信息，例如每个顶点的法向、每个面的法向、活动选择项的透视点和其他详细信息。 若要启用或禁用它们，请在“模型编辑器”工具栏上，选择“脚本” > “查看”，然后根据需要选择一个选项。

##### 创建并导入三维对象

要向场景中添加预定义的三维形状，请在“工具箱”中，选择需要的一个形状，然后将其移动到设计图面。 新形状定位在场景的原点。 模型编辑器提供七种形状：“圆锥体”、“立方体”、“圆柱体”、“圆盘”、“平面体”、“球面体”和“茶壶体”。

若要从文件导入三维对象，请在“模型编辑器”工具栏上，选择“高级” > “场景管理” > “导入”，然后指定要导入的文件。

##### Transform 对象

可以通过更改对象的“旋转”、“缩放”和“平移”属性转换对象。 “旋转”通过围绕由中心点定义的 x 轴、y 轴和 z 轴应用连续的旋转操作，来确定对象的方向。 每个旋转规范有三个分量 x、y 和 z，并以度数按此顺序指定分量。 “缩放”通过沿以中心点为中心的一个或多个轴按照指定系数拉伸对象，来调整其大小。 “平移”相对于对象的父级（而非其中心点）在三维空间中定位对象。

你可以使用建模工具或通过设置属性来转换对象。

###### 使用建模工具转换对象

1. 在“选择”模式下，选择要转换的对象。 显示透明框架时指示对象已选中。
2. 在“模型编辑器”工具栏上，选择“平移”、“缩放”或“旋转”工具。 此时将显示选定对象的平移、缩放或旋转操控器。
3. 使用操控器执行转换。 对于平移和缩放转换，操控器为轴指示器。 你可以一次更改一个轴，也可以使用指示器中心的白立方体同时更改所有轴。 对于旋转，操控器是按颜色编码的圆所构成的球体，每个圆分别对应 x 轴（红色）、y 轴（绿色）和 z 轴（蓝色）。 你必须分别更改每个轴才能创建你需要的旋转。

###### 通过设置对象属性来转换对象

1. 在“选择”模式下，选择要转换的对象。 显示透明框架时指示对象已选中。

2. 在“属性”窗口中，为“旋转”、“缩放”和“平移”属性指定值。

   Important

   对于“旋转”属性，请分别指定绕每一个轴旋转的度数。 旋转将按顺序应用，因此请确保先按 x 轴旋转，然后再按 y 轴、z 轴旋转，以此制定旋转计划。

通过使用建模工具，你可以快速创建转换，但不精确。 通过设置对象属性，你可以精确指定转换，但速度不快。我们建议你使用建模工具来获取“足够接近”你的需求的转换，然后微调属性值。

如果你不想使用操控器，可以启动自由模式。 在“模型编辑器”工具栏上，依次选择“脚本” > “工具” > “自由操纵”，以启用（或禁用）自由模式。 在自由模式下，你可以从设计图面上的任意点（而非操控器上的点）开始操纵。 在自由模式下，你可以通过锁定你不希望更改的轴来限制对某些轴的更改。 在“模型编辑器模式”工具栏上，选择“锁定 X”、“锁定 Y”和“锁定 Z”按钮的任意组合。

你可能会发现在处理对象时，网格线对齐很有用处。 在“模型编辑器模式”工具栏上，选择“对齐”可启用（或禁用）网格线对齐。 启用网格线对齐时，平移、旋转和缩放转换将受预定义增量的约束。

##### 使用透视点

对象的中心点定义其旋转和缩放的中心。 你可以更改对象的中心点，以更改旋转和缩放转换对它的影响。 在“模型编辑器模式”工具栏上，选择“透视模式”可启用（或禁用）透视模式。 启用透视模式时，选定对象的中心点上将显示一个小的轴指示器。 然后，可以使用“平移”和“旋转”工具操纵中心点。

有关如何使用透视点的演示，请参阅[如何：修改三维模型的透视点](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-modify-the-pivot-point-of-a-3-d-model?view=vs-2019)。

##### 世界和本地模式

平移和旋转可发生在对象的本地坐标系（或本地参考系）中，或世界坐标系（或世界参考系）中。 世界参考系与对象的旋转无关。 默认为本地模式。 要启用（或禁用）世界模式，请在“模型编辑器模式”工具栏上，选择“WorldLocal”按钮。

##### 修改对象

可以通过移动或删除三维对象的顶点、边和面来更改其形状。 默认情况下，模型编辑器处于对象模式，因此可以选择并转换整个对象。 若要选择点、边或面，请选择适当的选择模式。 在“模型编辑器模式”工具栏上，选择“选择模式”，然后选择所需的模式。

你可以通过延伸或细分来创建其他顶点。 延伸将复制面的顶点（共面顶点集），该面仍由复制后的顶点连接。 细分将添加顶点，在以前只有一个面的地方创建多个面。 若要创建新面，需添加新顶点（原始面中心的一个点，每条边中间的一个点），然后将其与原始顶点结合起来。 添加的面数与原始面中的边数相等。 在这两种情况下，你可以平移、旋转和缩放新的顶点来更改对象的几何图形。

###### 从对象延伸面

1. 在面选择模式下，选择要延伸的面。
2. 在“模型编辑器”工具栏上，依次选择“脚本” > “工具” > “延伸”。

###### 细分面

1. 在面选择模式下，选择要细分的面。 由于细分会创建新边数据，所以当多个面相邻时，同时细分所有面将得到更一致的结果。
2. 在“模型编辑器”工具栏上，依次选择“脚本” > “工具” > “细分”。

你还可以三角化面、合并对象和将多边形选定项转换为新对象。 三角化将创建其他边，以便将非三角形面转换为最优数目的三角形；但是，它不提供其他几何详细信息。 合并可将选定的对象组合为一个对象。 可从多边形选定项创建新对象。

###### 三角化面

1. 在面选择模式下，选择要三角化的面。
2. 在“模型编辑器”工具栏上，依次选择“脚本” > “工具” > “三角化”。

###### 合并对象

1. 在对象选择模式下，选择要合并的对象。
2. 在“模型编辑器”工具栏上，依次选择“脚本” > “工具” > “合并对象”。

###### 从多边形选定项创建对象

1. 在面选择模式下，选择要从中创建新对象的面。
2. 在“模型编辑器”工具栏上，依次选择“脚本” > “工具” > “从多边形选择创建新的对象”。

##### 使用材料和着色器

对象的外观取决于场景中照明的交互和对象的材料。 材料的定义取决于描述不同类型光源下图面的反应的属性，还有基于照明信息、纹理贴图、法线贴图和其他数据计算对象图面上每个像素的最终颜色的着色器程序。

模型编辑器提供以下默认材料：

| 材料       | 说明                                             |
| ---------- | ------------------------------------------------ |
| **不发光** | 不使用任何模拟照明呈现图面。                     |
| **朗伯**   | 使用模拟的环境照明和漫射照明呈现图面。           |
| **Phong**  | 使用模拟的环境照明、漫射照明和反射高光呈现图面。 |

其中每种材料都会向对象图面应用一种纹理。 你可以为使用材料的每个对象设置不同的纹理。

若要修改特定对象在场景中的不同光源下的反应，你可以更改材料的照明属性，而不影响使用该材料的其他对象。下表描述常见的照明属性：

| 照明属性   | 说明                               |
| ---------- | ---------------------------------- |
| **环境**   | 描述环境照明对图面的影响。         |
| **漫射**   | 描述平行光和点光对图面的影响。     |
| **放射**   | 描述图面如何发光，与其他照明无关。 |
| **反射**   | 描述图面如何反射平行光和点光。     |
| **反射力** | 描述反射高光的范围和强度。         |

根据材料支持的方面，你可以更改其照明属性、纹理和其他数据。 在“选择”模式下，选择需要更改材料的对象，然后在“属性”窗口中，更改“MaterialAmbient”、“MaterialDiffuse”、“MaterialEmissive”、“MaterialSpecular”、“MaterialSpecularPower”，或其他可用的属性。 材料可以最多显示八种纹理，其属性按顺序从“纹理 1”到“纹理 8”依次命名。

若要从对象中删除所有材料，请在“模型编辑器”工具栏上，依次选择“脚本” > “材料” > “删除材料”。

可以使用“着色器设计器”创建可应用于三维场景中的对象的自定义着色器材料。 有关如何创建自定义着色器材料的信息，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)。 有关如何将自定义着色器材料应用于对象的信息，请参阅[如何：向三维模型应用着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-apply-a-shader-to-a-3-d-model?view=vs-2019)。

##### 场景管理

你可以将场景作为对象的层次结构进行管理。 多个对象排列在层次结构中时，父节点的任何平移、缩放或旋转也影响其子级。 你要从较为基本的对象构造复杂对象或场景时，这种方法很有用处。

可以使用“文档大纲”窗口查看场景的层次结构并选择场景节点。 在大纲中选择节点时，可以使用“属性”窗口来修改其属性。

你可以通过两种方法构造对象的层次结构：将一个对象设为其他对象的父级；将对象分组为同级，用占位符节点充当其父级。

###### 创建具有父对象的层次结构

1. 在“选择”模式下，选择两个或多个对象。 所选的第一个将成为父对象。
2. 在“模型编辑器”工具栏上，依次选择“脚本” > “场景管理” > “附加到父级”。

###### 创建同级对象的层次结构

1. 在“选择”模式下，选择两个或多个对象。 占位符对象将创建并成为其父对象。
2. 在“模型编辑器”工具栏上，依次选择“脚本” > “场景管理” > “创建组”。

模型编辑器使用白色透明框架标识第一个选定的对象，它将成为父级。 选择的其他对象具有蓝色透明框架。 默认情况下，不显示占位符节点。 若要显示占位符节点，请在“模型编辑器”工具栏上，依次选择“脚本” > “场景管理” > “显示占位符节点”。 你可以处理占位符节点，就像处理非占位符的对象一样。

若要删除两个对象之间的父子关联，请选择子对象，然后在“模型编辑器”工具栏上，依次选择“脚本” > “场景管理” > “从父级分离”。 将父级与子对象分离时，子对象将成为场景中的根对象。

#### 键盘快捷键

| 命令                         | 键盘快捷键                                                   |
| ---------------------------- | ------------------------------------------------------------ |
| 切换到“选择”模式             | Ctrl+G，Ctrl+Q  **S**                                        |
| 切换到“缩放”模式             | Ctrl+G，Ctrl+Z  **Z**                                        |
| 切换到“平移”模式             | Ctrl+G，Ctrl+P  **K**                                        |
| 全选                         | Ctrl+A                                                       |
| 删除当前选定内容             | **删除**                                                     |
| 取消当前选择                 | Escape (Esc)                                                 |
| 放大                         | 向前滚动鼠标滚轮  Ctrl+向前滚动鼠标滚轮  Shift+向前滚动鼠标滚轮  Ctrl+PgUp  加号 (+) |
| 缩小                         | 向后滚动鼠标滚轮  Ctrl+向后滚动鼠标滚轮  Shift+向后滚动鼠标滚轮  Ctrl+PgDn  减号 (-) |
| 向上平移照相机               | PgDn                                                         |
| 向下平移照相机               | PgUp                                                         |
| 向左平移照相机               | 向左滚动鼠标滚轮  Ctrl+PgDn                                  |
| 向右平移照相机               | 向右滚动鼠标滚轮  Ctrl+PgDn                                  |
| 查看模型顶部                 | Ctrl+L，Ctrl+T  **T**                                        |
| 查看模型底部                 | Ctrl+L，Ctrl+U                                               |
| 查看模型左侧                 | Ctrl+L，Ctrl+L                                               |
| 查看模型右侧                 | Ctrl+L，Ctrl+R                                               |
| 查看模型正面                 | Ctrl+L，Ctrl+F                                               |
| 查看模型背面                 | Ctrl+L，Ctrl+B                                               |
| 框选窗口中的对象             | **F**                                                        |
| 切换透明框架模式             | Ctrl+L，Ctrl+W                                               |
| 切换网格线对齐               | Ctrl+G，Ctrl+N                                               |
| 切换透视模式                 | Ctrl+G，Ctrl+V                                               |
| 切换 x 轴限制                | Ctrl+L，Ctrl+X                                               |
| 切换 y 轴限制                | Ctrl+L，Ctrl+Y                                               |
| 切换 z 轴限制                | Ctrl+L，Ctrl+Z                                               |
| 切换到平移模式               | Ctrl+G，Ctrl+W  **W**                                        |
| 切换到缩放模式               | Ctrl+G，Ctrl+E  **E**                                        |
| 切换到旋转模式               | Ctrl+G，Ctrl+R  **R**                                        |
| 切换到点选择模式             | Ctrl+L，Ctrl+1                                               |
| 切换到边选择模式             | Ctrl+L，Ctrl+2                                               |
| 切换到面选择模式             | Ctrl+L，Ctrl+3                                               |
| 切换到对象选择模式           | Ctrl+L，Ctrl+4                                               |
| 切换到轨迹（照相机）模式     | Ctrl+G，Ctrl+O                                               |
| 选择场景中的下一对象         | Tab                                                          |
| 选择场景中的上一对象         | **Shift**+**Tab**                                            |
| 基于当前工具操纵选定的对象。 | 箭头键                                                       |
| 停用当前操控器               | **Q**                                                        |
| 旋转照相机                   | Alt+按住鼠标左键拖动                                         |

#### 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [处理游戏和应用的三维资产](https://docs.microsoft.com/zh-cn/visualstudio/designers/working-with-3-d-assets-for-games-and-apps?view=vs-2019) | 概述可以用来处理图形资产（例如纹理和图像、三维模型和着色器效果）的 Visual Studio 工具。 |
| [图像编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019) | 介绍如何使用 Visual Studio 图像编辑器处理纹理和图像。        |
| [着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019) | 描述如何使用 Visual Studio 着色器设计器处理着色器。          |

### [Model editor examples](https://docs.microsoft.com/en-us/visualstudio/designers/model-editor-examples?view=vs-2019)

本节文档中的文章包含演示如何使用模型编辑器的示例。

| Title                                                        | 说明                                 |
| ------------------------------------------------------------ | ------------------------------------ |
| [如何：创建基本三维模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-3-d-model?view=vs-2019) | 介绍如何创建基本三维模型。           |
| [如何：修改三维模型的透视点](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-modify-the-pivot-point-of-a-3-d-model?view=vs-2019) | 介绍如何修改三维模型的透视点和规模。 |
| [如何：构建三维地形模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-model-3-d-terrain?view=vs-2019) | 描述如何创建基本横向场景。           |
| [如何：向三维模型应用着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-apply-a-shader-to-a-3-d-model?view=vs-2019) | 介绍如何向三维模型应用着色器。       |

#### [Create a basic 3D model](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-a-basic-3-d-model?view=vs-2019)

本文说明如何使用模型编辑器创建基本三维模型。 包含以下活动：

- 将对象添加到场景中
- 选择面和边缘
- 转换选定内容
- 使用“细分面”和“延伸面”工具
- 使用“三角测量”命令

##### 创建基本三维模型

可使用模型编辑器创建和修改游戏或应用的三维模型和场景。 下列步骤说明如何使用模型编辑器创建房屋的简化三维模型。 简化模型可用作仍在创建的最终艺术资产的替代物、用作冲突检测的网格或用作在所表示的对象太远而无法从更详细的呈现中获益时要使用的详细程度低的模型。

完成后，模型应类似于：

![简约建筑的已完成模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_model_demo_house_final.png?view=vs-2019)

开始前，请确保显示“属性”窗口和“工具箱”。

###### 创建房屋的简化三维模型

1. 创建要使用的三维模型。 若要了解如何向项目添加模型，请参阅[模型编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/model-editor?view=vs-2019)中的“入门”部分。

2. 将立方体添加到场景中。 在“工具箱”窗口的“形状”下，选择“立方体”，然后将其移动到设计图面。

3. 切换到面选择。 在“模型编辑器”工具栏上，选择“选择面”。

4. 细分立方体的顶部。 在面选择模式下，选择立方体一次将其激活以供选择，然后选择立方体的顶部以选择顶部面。 在“模型编辑器”工具栏上，选择“细分面”。 这会向立方体的顶部添加新顶点，这些顶点将立方体拆分为四个大小相等的分区。

   ![已对立方体的顶端进行细分](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_model_demo_house_subdiv.png?view=vs-2019)

5. 延伸立方体的两条相邻边 - 例如，立方体的前边和右边。 在面选择模式下，选择立方体一次将其激活以供选择，然后选择立方体的一边。 按住 Ctrl 键，选择与首先选择的立方体边相邻的另一个边，然后在“模型编辑器”工具栏上选择“延伸面”。

   ![已延伸立方体的两侧](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_model_demo_house_extrude.png?view=vs-2019)

6. 扩展其中一个延伸。 选择刚延伸的某个面，然后在“模型编辑器”工具栏上选择“平移”工具，并按延伸的方向移动平移操控程序。

   ![已进一步延伸立方体的一侧。](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_model_demo_house_extend.png?view=vs-2019)

7. 对模型进行三角测量。 在“模型编辑器”工具栏上，依次选择“高级” > “工具” > “三角化”。

8. 创建房子的屋顶。 选择“模型编辑器”工具栏上的“选择边”切换到边选择模式，然后选择立方体将其激活。 选择此处显示的边时，请按住 Ctrl 键：

   ![将形成屋顶顶端的边缘](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_model_demo_house_edges.png?view=vs-2019)

   选择边后，请在“模型编辑器”工具栏上选择“平移”工具，然后将平移操控程序上移来创建房子的屋顶。

   简化的房子模型已完成。 下面是应用了平面着色的最终模型：

   ![简约建筑的已完成模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_model_demo_house_final.png?view=vs-2019)

   下一步，可以将着色器应用于此三维模型。 有关详细信息，请参阅[如何：向三维模型应用着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-apply-a-shader-to-a-3-d-model?view=vs-2019)。

#### [Modify the pivot point of a 3D model](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-modify-the-pivot-point-of-a-3-d-model?view=vs-2019)

本文说明如何使用模型编辑器修改三维模型的透视点。 透视点是空间中的点，定义用于旋转和缩放的对象的数学中心。

##### 修改三维模型的透视点

可以通过修改三维模型的透视点来重新定义三维模型的原点。

请确保显示“属性”窗口和“工具箱”。

1. 从现有的三维模型开始，例如[如何：创建基本三维模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-3-d-model?view=vs-2019)中所述的模型。

2. 进入透视模式。 在“模型编辑器模式”工具栏上，选择“透视模式”按钮以激活透视模式。 “透视模式”按钮周围将显示一个框，用于指示模型编辑器现在处于透视模式中。 在透视模式中，转换等操作会影响对象的透视点，而不影响世界空间中对象的结构。

3. 修改对象的透视点。 在“选择”模式中，选择对象，然后在“模型查看器”工具栏上选择“转换”工具。 一个表示透视点的框显示在设计图面上。 移动框以修改对象的透视点。

   通过移动框，可以在所有三个维度中移动透视点。 若要沿一个轴转换透视点，请移动与该轴相对应的箭头。框和箭头将更改为黄色以指示受转换影响的轴。

   还可以使用“属性”窗口中的“透视转换”属性以指定透视点。

   Tip

   可以通过旋转对象来查看新透视点的效果。 若要旋转它，请使用“旋转”工具或修改“旋转”属性。

下面是具有修改后的中心点的模型：

![具有已修改透视点的建筑模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-modified-model.png?view=vs-2019)

#### [Model 3D terrain](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-model-3-d-terrain?view=vs-2019)

本文说明如何使用模型编辑器创建三维地形模型。

##### 创建三维地形模型

细分平面以创建其他的面，然后对其顶点进行处理以创建有趣的地形特征，借此创建三维地形。

完成后，模型应类似于：

![显示地形模型的三维场景](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-terrain-model.png?view=vs-2019)

开始前，请确保显示“属性”窗口和“工具箱”。

1. 创建要使用的三维模型。 若要了解如何向项目添加模型，请参阅[模型编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/model-editor?view=vs-2019)中的“入门”部分。

2. 将平面添加到场景中。 在“工具箱”中的“形状”下，选择“平面”，然后将其移到设计图面。

   Tip

   为了使平面对象更易于使用，可以在设计图面中对向其添加框架。 在“选择”模式中，选择平面对象，然后在“模型编辑器”工具栏上，选择“框选对象”按钮。

3. 进入面选择模式。 在“模型编辑器”工具栏上，选择“选择面”。

4. 细分平面。 在面选择模式中，选择平面一次将其激活以供选择，然后再次选择它以仅选择其面。 在“模型编辑器”工具栏上，选择“细分面”。 这会向平面添加新的顶点，这些顶点将平面拆分为四个大小相等的分区。

5. 创建更多细分面。 在选中新面的同时，再选择两次“细分面”。 这总共将创建 64 个面。 通过创建更多的细分面，可让地形具有更多的细节。

6. 进入点选择模式。 在“模型编辑器”工具栏上，选择“选择点”。

7. 修改点以创建地形特征。 在点选择模式中，选择其中一个点，然后在“模型编辑器”工具栏上选择“转换”工具。 一个表示点的框显示在设计图面上。 使用绿色箭头移动框，从而修改点的高度。 对不同的点重复此步骤以创建有趣的地形特征。

   Tip

   可以一次性选择多个点以统一修改它们。

地形模型已完成。 下面是应用了 Phong 着色的最终模型：

![显示地形模型的三维场景](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-terrain-model.png?view=vs-2019)

可以使用此地形模型演示[如何：创建基于几何图形的渐变着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-geometry-based-gradient-shader?view=vs-2019)中所述的渐变着色器的效果。

#### [Apply a shader to a 3D model](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-apply-a-shader-to-a-3-d-model?view=vs-2019)

本文演示如何使用模型编辑器将定向关系图着色器语言 (DGSL) 着色器应用于三维模型。

##### 向三维模型应用着色器

可对三维模型应用着色效果，使其具有有趣的外观。

开始前，请确保显示“属性”窗口”。

1. 从包含一个或多个模型的三维场景开始。 如果没有合适的三维场景，请按照[如何：创建基本三维模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-3-d-model?view=vs-2019)中所述进行创建。 还必须具有可应用于模型的 DGSL 着色器。 如果没有合适的着色器，请按照[如何：创建基本颜色着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-color-shader?view=vs-2019)中所述进行创建，并确保已将其保存到文件中，然后再继续操作。
2. 在“选择”模式中，选择要应用着色器的模型，然后在“属性”窗口的“效果”属性组中的“文件名”属性中，指定要应用到模型的 DGSL 着色器。

以下模型应用了基本颜色效果：

![显示基本颜色效果的三维场景](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-3d-model-effect.png?view=vs-2019)

将着色器应用到模型后，可在着色器设计器中打开它，方式是选择模型，然后在“属性”窗口的“效果”属性组的 **(Advanced)** 属性中选择省略号 (**...**) 按钮。

## [Work with shaders](https://docs.microsoft.com/en-us/visualstudio/designers/working-with-shaders?view=vs-2019)

可以使用 Visual Studio 中基于图形的着色器设计器来设计自定义着色器效果。 可以在基于 DirectX 的游戏或应用中使用这些着色器。

### 着色器

着色器是一种执行图形计算（例如顶点转换或像素着色）的计算机程序，并且通常在图形处理单元 (GPU) 上运行，而不是在 CPU 上运行。 因为现在大多数传统、固定功能图形管道的阶段是由着色器程序来执行，因此可以使用它们来创建特定于应用需求的管道。

最常见类型的着色器是顶点着色器和像素着色器；前者执行每顶点计算并替换不可编程的图形硬件中的固定功能转换和照明电路，后者执行确定像素颜色的每像素计算，并替换不可编程的图形硬件中的固定功能颜色组合器电路。现代图形硬件使更多类型的着色器成为了可能 - 用于图形计算的外壳着色器、域着色器和几何着色器，以及用于非图形计算的计算着色器。 在这些阶段中，甚至没有一个阶段在不可编程的图形硬件中可用。 着色器最初是通过使用提供数据并行 (SIMD) 和以图形为中心的 (点积) 指令的类似汇编语言所创建的。 现在，着色器通常是通过使用类似于 C 的高级别语言所创建的，如 HLSL（高级着色器语言）。

可以使用着色器设计器以交互方式创建像素着色器，而不是通过输入和编译代码进行创建。 在着色器设计器中，着色器是由代表数据和操作的大量节点以及代表通过着色器流动的数据值和中间结果的节点之间的连接所定义的。通过使用此方法和着色器设计器中的实时预览，可以更轻松地可视化着色器的执行并通过试验“发现”有趣的着色器变体。

### DGSL 文档

着色器设计器以有向图着色器语言 (DGSL) 格式保存着色器，该格式是一种基于有向图标记语言 (DGML) 的 XML 格式。 可以在模型编辑器中直接对 3D 模型应用 DGSL 着色器。 但是，在应用中使用 DGSL 着色器之前，必须将其导出为 DirectX 理解的格式（例如 HLSL）。

由于 DGSL 与 DGML 兼容，因此可以使用旨在分析 DGML 文档的工具来分析 DGSL 着色器。 有关 DGML 的信息，请参阅[了解有向图形标记语言 (DGML)](https://docs.microsoft.com/zh-cn/visualstudio/modeling/customize-code-maps-by-editing-the-dgml-files?view=vs-2019)。

### 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019) | 描述如何使用 Visual Studio 着色器设计器处理着色器。          |
| [着色器设计器节点](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer-nodes?view=vs-2019) | 讨论可用于实现图形效果的着色器设计器节点的种类。             |
| [着色器设计器示例](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer-examples?view=vs-2019) | 提供转至演示如何使用着色器设计器来实现常见图形效果的主题的链接。 |

### [Shader designer](https://docs.microsoft.com/en-us/visualstudio/designers/shader-designer?view=vs-2019)

本文档介绍如何使用 Visual Studio 着色器设计器来创建、修改和导出名为“着色器”的自定义视觉效果。

即使不了解高级着色器语言 (HLSL) 编程，也可以使用着色器设计器来创建游戏或应用的自定义视觉效果。 若要在“着色器设计器”中创建着色器，只需将其作为图形进行布局。 即添加到表示数据和操作的设计图面节点，然后在二者之间建立连接来定义操作处理数据的方式。 在每个操作节点处，提供了到该点的效果预览，使你能够对其结果进行可视化。 数据通过节点流向表示着色器输出的最后一个节点。

#### 支持的格式

着色器设计器支持以下着色器格式：

| 格式名称                    | 文件扩展名 | 支持的操作（查看、编辑、导出） |
| --------------------------- | ---------- | ------------------------------ |
| 有向图着色器语言            | .dgsl      | 查看、编辑                     |
| HLSL 着色器（源代码）       | .hlsl      | 导出                           |
| HLSL 着色器（字节码）       | .cso       | 导出                           |
| C++ 标头（HLSL 字节码数组） | .h         | 导出                           |

#### 入门

本节描述如何将 DGSL 着色器添加到 Visual Studio C++ 项目中，并提供可帮助你入门的基本信息。

Note

图像项（例如着色器图形）的自动生成集成仅支持 C++ 项目。

##### 将 DGSL 着色器添加到您的项目中

1. 确保你已安装使用图形所需的必备 Visual Studio 组件。 组件称为图像和三维模型编辑器。

   若要安装它，通过从菜单栏中选择“工具” > “获取工具和功能”打开 Visual Studio 安装程序，然后选择“单个组件”选项卡。选择“游戏和图形”类别下的“图像和三维模型编辑器”组件，然后选择“修改”。

   ![图像和三维模型编辑器组件](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/image-3d-model-editors-component.png?view=vs-2019)

2. 在“解决方案资源管理器”中，打开要向其添加着色器的 C++ 项目的快捷菜单，然后选择“添加” > “新项”。

3. 在“添加新项”对话框中的“已安装”下，选择“图形”，然后选择“视觉着色器图(.dgsl)”。

   Note

   如果没有看到“添加新项”对话框中的“图形”类别，且你已安装“图像和三维模型编辑器”组件，则图形项不支持你的项目类型。

4. 指定着色器文件的“名称”和需要的创建“位置”。

5. 选择 **“添加”** 按钮。

##### 默认着色器

每次创建 DGSL 着色器时，它最初为最小着色器，仅具有连接到“最终颜色”节点的一个“点颜色”节点。 尽管此着色器完整且可工作，但没有多少用。 因此，创建有效着色器的第一步通常是删除“点颜色”节点，或将其从“最终颜色”节点断开连接以为其他节点留出空间。

#### 使用着色器设计器

以下各节描述了如何将着色器设计器与自定义着色器一起使用。

##### 着色器设计器工具栏

着色器设计器工具栏包含有助于使用 DGSL 着色器图的命令。

影响着色器设计器状态的命令位于主 Visual Studio 窗口中的“着色器设计器模式”工具栏上。 设计工具和命令均位于着色器设计器设计图面上的“着色器设计器”工具栏上。

以下是“着色器设计器模式”工具栏：

![着色器设计器模式工具栏。](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-dsd-modal-toolbar.png?view=vs-2019)

下表介绍了“着色器设计器模式”工具栏上的项，按其从左至右的显示顺序列出：

| 工具栏项           | 说明                                                         |
| ------------------ | ------------------------------------------------------------ |
| **选择**           | 启用关系图中节点与边缘的交互。 在此模式下，可以选择节点并移动或删除它们，也可以建立边缘或中断它们。 |
| **平移**           | 相对于窗口框架移动着色器图。 若要进行平移，请选择设计图面上的一个点，然后将其四处移动。  在“选择”模式下，可以按住 Ctrl 来暂时激活“平移”模式。 |
| **缩放**           | 相对于窗口框架显示更多或更少的着色器图详细信息。 在“缩放”模式下，选择设计图面上的一个点，然后将其向右或向下移动可放大，向左或向上移动可缩小。  在“选择”模式下，可以按住 Ctrl，使用鼠标滚轮来缩小或放大。 |
| **缩放到合适大小** | 在窗口框架中显示完整的着色器图。                             |
| **实时呈现模式**   | 启用实时呈现时，即使没有执行用户操作，Visual Studio 也将重绘设计图面。 此模式用于处理随时间变化的着色器。 |
| **用球体预览**     | 启用后，球体的模型将用于预览着色器。 一次只能启用一个预览形状。 |
| **用立方体预览**   | 启用后，立方体的模型将用于预览着色器。 一次只能启用一个预览形状。 |
| **用圆柱体预览**   | 启用后，圆柱体的模型将用于预览着色器。 一次只能启用一个预览形状。 |
| **用圆锥体预览**   | 启用后，圆锥体的模型将用于预览着色器。 一次只能启用一个预览形状。 |
| **用茶壶体预览**   | 启用后，茶壶体的模型将用于预览着色器。 一次只能启用一个预览形状。 |
| **用平面预览**     | 启用后，平面的模型将用于预览着色器。 一次只能启用一个预览形状。 |
| **工具箱**         | 交替显示或隐藏“工具箱”。                                     |
| **属性**           | 交替显示或隐藏“属性”窗口。                                   |
| **高级**           | 包含高级命令和选项。  **导出**：允许以多种格式导出着色器。  **导出为**：将着色器导出为 HLSL 源代码或已编译的着色器字节码。 有关如何导出着色器的详细信息，请参阅[如何：导出着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-shader?view=vs-2019)。  **图形引擎**：允许选择用于显示设计图面的呈现器。  **使用 D3D11 呈现**：使用 Direct3D 11 呈现着色器设计器设计图面。  **使用 D3D11WARP 呈现**：使用 Direct3D 11 Windows 高级光栅化平台 (WARP) 呈现着色器设计器设计图面。  **视图**：允许选择有关着色器设计器的其他信息。  **帧速率**：启用后，会在设计图面的右上角显示当前帧速率。 帧速率为每秒绘制的帧数。 在启用“实时呈现模式”选项时，此选项才有用。 |

Tip

可以选择“高级”按钮再次运行上一个命令。

##### 使用节点和连接

使用“选择”模式来添加、删除、重新定位、连接和配置节点。 以下介绍了如何执行这些基本操作：

###### 在“选择”模式下执行基本操作

- 操作方法如下：
  - 若要将节点添加到图中，请在“工具箱”中将其选中，然后移动到设计图面。
  - 若要从图中删除节点，请将其选中，然后按 Delete。
  - 若要重新定位节点，将其选中，然后移动到新位置。
  - 若要连接两个节点，请将一个节点的输出终端移动到另一节点的输入终端。 仅可连接具有兼容类型的终端。 终端之间的线显示该连接。
  - 若要删除连接，请在任一连接的终端的快捷菜单上，选择“断开链接”。
  - 若要配置节点的属性，请选择该节点，然后在“属性”窗口中，为属性指定新值。

##### 预览着色器

为了帮助了解着色器在应用中的显示方式，可以配置效果的预览方式。 为了达到近似应用中的效果，可以选择要呈现的多个形状之一、配置纹理和其他材料参数、启用基于时间的动画效果，并从不同的角度检查预览。

###### 形状

着色器设计器包括六个形状 - 球体、立方体、圆柱体、圆锥体、茶壶体和平面，可使用这些形状预览着色器。 视着色器而定，某些形状可能会提供更好的预览效果。

若要选择预览形状，在“着色器设计器模式”工具栏上，选择所需的形状。

###### 纹理和材料参数

许多着色器依赖于纹理和材料属性，为应用中的每种对象生成唯一外观。 若要查看着色器在应用中的外观，可以设置用于呈现预览的纹理和材料属性，以匹配在应用中可能采用的纹理和参数。

将不同的纹理绑定到一个纹理寄存器中，或修改其他材料参数：

1. 在“选择”模式下，选择设计图面的空白区域。 这将使“属性”窗口显示全局着色器属性。
2. 在“属性”窗口中，为要更改的纹理和参数属性指定新值。

下表显示可以修改的着色器参数：

| 参数            | 属性                                                         |
| --------------- | ------------------------------------------------------------ |
| 纹理 1 - 纹理 8 | **访问**： 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **文件名**：与此纹理寄存器关联的纹理文件的完整路径。 |
| **材料环境**    | **访问**： 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值**：间接（或环境）光照引起的当前像素的漫射颜色。 |
| **材料漫射**    | **访问**：如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值**：一种颜色，描述当前像素如何漫射直接光照。 |
| **材料放射**    | **访问**： 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值**：由自发光照引起的当前像素的颜色量。 |
| **材料反射**    | **访问**： 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值**：一种颜色，描述当前像素如何反射直接光照。 |
| **材料光泽度**  | **访问**： 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值**：用于定义当前像素上反射高光的强度的指数。 |

###### 基于时间的效果

某些着色器具有基于时间的组件，可对效果进行动画处理。 若要显示操作中的效果，必须每秒更新几次预览。 默认情况下，只在更改着色器时更新预览；若要更改此行为，以实现查看基于时间的效果，则必须启用实时呈现。

若要启动实时呈现，在着色器设计器工具栏上，选择“实时呈现”。

###### 检查效果

许多着色器会受视角或定向光照等变量的影响。 若要检查这些变量更改时效果会如何响应，可以自由地旋转预览形状，并观察着色器的表现。

若要旋转形状，按住 Alt 键，然后在设计图面上选择任意点，并移动它。

##### 导出着色器

在应用中使用着色器之前，必须将其导出为 DirectX 理解的格式。

可以将着色器导出为 HLSL 源代码或已编译的着色器字节码。 HLSL 源代码导出到文件扩展名为 .hlsl 的文本文件中。 可将着色器字节码导出到文件扩展名为 .cso 的原始二进制文件，或者导出到将着色器字节码编码为数组的 C++ 标头 (.h) 文件。

有关如何导出着色器的详细信息，请参阅[如何：导出着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-shader?view=vs-2019)。

#### 键盘快捷键

| 命令                                                         | 键盘快捷键                                           |
| ------------------------------------------------------------ | ---------------------------------------------------- |
| 切换到“选择”模式                                             | Ctrl+G，Ctrl+Q  **S**                                |
| 切换到“缩放”模式                                             | Ctrl+G，Ctrl+Z  **Z**                                |
| 切换到“平移”模式                                             | Ctrl+G，Ctrl+P  **K**                                |
| 全选                                                         | Ctrl+A                                               |
| 删除当前选定内容                                             | **删除**                                             |
| 取消当前选择                                                 | Escape (Esc)                                         |
| 放大                                                         | Ctrl+向前滚动鼠标滚轮  加号 (+)                      |
| 缩小                                                         | Ctrl+向后滚动鼠标滚轮  减号 (-)                      |
| 向上平移设计图面                                             | 向后滚动鼠标滚轮  PgDn                               |
| 向下平移设计图面                                             | 向前滚动鼠标滚轮  PgUp                               |
| 向左平移设计图面                                             | Shift+向后滚动鼠标滚轮  向左滚动鼠标滚轮  Shift+PgDn |
| 向右平移设计图面                                             | Shift+向前滚动鼠标滚轮  向右滚动鼠标滚轮  Shift+PgUp |
| 将键盘焦点移到另一节点                                       | 箭头键                                               |
| 选择具有键盘焦点的节点（将该节点添加到选择组中）             | Shift+空格键                                         |
| 切换选择具有键盘焦点的节点                                   | Ctrl+空格键                                          |
| 切换当前所选内容（如果未选中任何节点，则选择具有键盘焦点的节点） | **空格键**                                           |
| 向上移动当前选定内容                                         | Shift+向上键                                         |
| 向下移动当前选定内容                                         | Shift+向下键                                         |
| 向左移动当前选定项                                           | Shift+向左键                                         |
| 向右移动当前选定内容                                         | Shift+向右键。                                       |

#### 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [处理游戏和应用的三维资产](https://docs.microsoft.com/zh-cn/visualstudio/designers/working-with-3-d-assets-for-games-and-apps?view=vs-2019) | 概述了可用来处理纹理和图像、三维模型和着色器效果的 Visual Studio 工具。 |
| [图像编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019) | 介绍如何使用 Visual Studio 图像编辑器处理纹理和图像。        |
| [模型编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/model-editor?view=vs-2019) | 描述如何使用 Visual Studio 模型编辑器处理三维模型。          |

### [Shader designer nodes](https://docs.microsoft.com/en-us/visualstudio/designers/shader-designer-nodes?view=vs-2019)

文档本部分文章包含关于用于创建图形效果的各种着色器设计器节点的信息。

#### 节点和节点类型

着色器设计器以图的方式表示可视化效果。 这些图通过采用精确方式专门选择和连接的节点生成，以实现预期效果。 每一个节点表示一条信息或一个数学函数，而它们之间的连接表示信息如何流经图生成结果。 着色器设计器提供了六种不同的节点类型（筛选器、纹理节点、参数、常数、实用程序节点和数学运算节点），并且每种类型都包含一系列单个节点。 这些节点和节点类型在本节其他文章中也有介绍。 有关详细信息，请参见本文档末尾的链接。

####节点结构

所有节点由常见元素的组合组成。 每个节点在它的右侧都至少有一个输出终端（最终颜色节点除外，它表示着色器的输出）。 表示计算或纹理取样器的节点的左侧有输入终端，但表示信息的节点没有输入终端。 输出终端与输入终端是连接的，以便在节点之间移动信息。

##### 输入的提升

因为着色器设计器必须最终生成 HLSL 源代码，以便效果可用于游戏或应用，所以着色器设计器节点必须遵守 HLSL 使用的类型提升规则。 因为图形硬件主要以浮点值运行，所以不同类型之间的类型提升（例如，从 `int` 到 `float`或从 `float` 到 `double`）是不常见的。 因为图形硬件一次对多条信息使用相同运算，所以可以发生不同种类的提升，其中较短的输入会延长，以匹配最长输入的大小。 延长方式取决于输入类型，也取决于运算本身：

- “如果较小类型为标量值，那么：

  标量值会复制到矢量中，该矢量大小与较大输入相同。 例如，当运算的最大输入是三元矢量时，标量输入 5.0 变为矢量 (5.0, 5.0, 5.0)，无论是什么运算，都是如此。

- 如果较小类型是矢量，并且运算为乘法（*、/、% 等），那么：

  矢量的值复制到与较大输入大小相等的矢量的前导元素中，并将尾随元素设置为 1.0。 例如，矢量输入与四元矢量相乘时，矢量输入 (5.0, 5.0) 变为矢量 (5.0, 5.0, 1.0, 1.0)。 通过使用乘法标识 1.0 来保留输出的第三和第四元素。

- 如果较小类型是矢量，并且运算是加法（+、 - 等），那么

  矢量的值复制到与较大输入大小相等的矢量的前导元素中，并将尾随元素设置为 0.0。 例如，矢量输入与四元矢量相加时，矢量输入 (5.0, 5.0) 变为矢量 (5.0, 5.0, 0.0, 0.0)。 通过使用加法标识 0.0来保留输出的第三和第四元素。

#### 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [常量节点](https://docs.microsoft.com/zh-cn/visualstudio/designers/constant-nodes?view=vs-2019) | 介绍可在着色器计算中用来表示文本值和内插顶点状态信息的节点。 因为顶点状态是内插的，因此每个像素的顶点状态不同，每个像素着色器实例会接收不同版本的常量。 |
| [参数节点](https://docs.microsoft.com/zh-cn/visualstudio/designers/parameter-nodes?view=vs-2019) | 介绍可在着色器计算中用来表示照相机位置、材料属性、照明参数、时间和其他应用状态信息的节点。 |
| [纹理节点](https://docs.microsoft.com/zh-cn/visualstudio/designers/texture-nodes?view=vs-2019) | 介绍可用于各种纹理类型和几何图形采样，并以常用方法生成或转换纹理坐标的节点。 |
| [数学运算节点](https://docs.microsoft.com/zh-cn/visualstudio/designers/math-nodes?view=vs-2019) | 介绍可用来执行代数、逻辑、三角函数和其他数学运算的节点，这些运算直接映射到 HLSL 指令。 |
| [实用工具节点](https://docs.microsoft.com/zh-cn/visualstudio/designers/utility-nodes?view=vs-2019) | 介绍可用来执行常见照明计算和其他常见运算的节点，这些操作不直接映射到 HLSL 指令。 |
| [筛选节点](https://docs.microsoft.com/zh-cn/visualstudio/designers/filter-nodes?view=vs-2019) | 介绍可用来执行纹理筛选和颜色筛选的节点。                     |

#### [Constant nodes](https://docs.microsoft.com/en-us/visualstudio/designers/constant-nodes?view=vs-2019)

在着色器设计器中，常量节点表示像素着色器计算中的文字值和内插顶点属性。 由于顶点属性是内插的，因此每个像素的此属性不同，每个像素着色器实例会接收不同版本的常量。 这向每个像素赋予了独特的外观。

##### 顶点属性内插

在游戏或应用中，通过将顶点、基元定义和顶点属性所定义的多个对象转换成屏幕像素进行 3D 场景图像的绘制。通过顶点属性提供赋予像素独特外观所需的全部信息，顶点属性根据像素的相似度与构成其*基元*的不同顶点混合在一起。 基元是基本的呈现元素；即点、线或三角形等简单形状。 非常靠近某一顶点的像素将接收与该顶点几乎相同的常数，但是在基元的所有顶点之间均匀间隔的像素将接收这些顶点平均值的常数。 在图形编程中，像素接收的常量被称为*内插*。 按此方式向像素提供常量数据将产生非常好的视觉质量，同时会降低内存占用空间和带宽要求。

虽然每个像素着色器实例都只接收一组常量值，并且不能更改这些值，但不同的像素着色器实例会接收不同的常量数据集。 此设计使着色器程序能够为基元中的每个像素生成不同的颜色输出。

##### 常量节点引用

| 节点                 | 详细信息                                                     | 属性              |
| -------------------- | ------------------------------------------------------------ | ----------------- |
| **相机向量**         | 从当前像素延伸到世界空间中相机的向量。  它可用于计算世界空间中的反射。  **输出**  `Output`: `float3` 从当前像素到相机的向量。 | 无                |
| **颜色常量**         | 常量颜色值。  **输出**  `Output`: `float4` 颜色值。          | **输出** 颜色值。 |
| **常量**             | 常量标量值。  **输出**  `Output`: `float` 标量值。           | **输出** 标量值。 |
| **二维常量**         | 双分量矢量常数。  **输出**  `Output`: `float2` 矢量值。      | **输出** 矢量值。 |
| **三维常量**         | 三分量矢量常数。  **输出**  `Output`: `float3` 矢量值。      | **输出** 矢量值。 |
| **四维常量**         | 四分量矢量常数。  **输出**  `Output`: `float4` 颜色值。      | **输出** 矢量值。 |
| **标准化位置**       | 以标准化设备坐标表示的当前像素的位置。  x 坐标和 y 坐标具有 [-1, 1] 范围内的值，z 坐标具有 [0, 1] 范围中的值，w 分量包含视图空间中的点深度值；w 未标准化。  **输出**  `Output`: `float4` 当前像素的位置。 | 无                |
| **点颜色**           | 当前像素的漫射颜色，它是材质漫射颜色和顶点颜色属性的组合。  **输出**  `Output`: `float4` 当前像素的漫射颜色。 | 无                |
| **点深度**           | 视图空间中当前像素的深度。  **输出**  `Output`: `float` 当前像素的深度。 | 无                |
| **标准化点深度**     | 以标准化设备坐标表示的当前像素的深度。  结果的值在 [0, 1] 的范围内。  **输出**  `Output`: `float` 当前像素的深度。 | 无                |
| **屏幕位置**         | 以屏幕坐标表示的当前像素的位置。  屏幕坐标基于当前视区。 x 和 y 分量包含屏幕坐标，z 分量包含标准化为 [0, 1] 范围的深度，w 分量包含视图空间中的深度值。  **输出**  `Output`: `float4` 当前像素的位置。 | 无                |
| **表面法线**         | 当前像素在对象空间内的表面法线。  它可用于计算对象空间中的光照量和光照反射。  **输出**  `Output`: `float3` 当前像素的表面法线。 | 无                |
| **切空间照相机向量** | 从当前像素延伸到切空间中相机的向量。  它可用于计算切空间中的反射。  **输出**  `Output`: `float3` 从当前像素到相机的向量。 | 无                |
| **切空间灯光方向**   | 定义在当前像素的切空间中从光源投射出的光线方向的向量。  它可用于计算切空间中的光照量和反射量。  **输出：**  `Output`: `float3` 从当前像素到光源的矢量。 | 无                |
| **世界法线**         | 当前像素在世界空间内的表面法线。  它可用于计算世界空间内的光照量和光照反射。  **输出**  `Output`: `float3` 当前像素的表面法线。 | 无                |
| **世界位置**         | 当前像素在世界空间内的位置。  **输出**  `Output`: `float4` 当前像素的位置。 |                   |

#### [Parameter nodes](https://docs.microsoft.com/en-us/visualstudio/designers/parameter-nodes?view=vs-2019)

在着色器设计器中，参数节点表示受应用控制、以每个绘图为基础的着色器输入，例如，材料属性、定向光、照相机位置和时间。 由于可以使用每个绘图调用更改这些参数，因此可使用相同的着色器为某个对象提供不同的外观。

##### 参数节点参考

| 节点               | 详细信息                                                     | 属性                                                         |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **照相机世界位置** | 照相机在世界空间内的位置。  **输出：**  `Output`: `float4` 照相机的位置。 | 无                                                           |
| **灯光方向**       | 定义在世界空间中从光源投射出的光线方向的矢量。  它可用于计算世界空间中的光照量和反射量。  **输出：**  `Output`: `float3` 从当前像素到光源的矢量。 | 无                                                           |
| **材料环境**       | 间接光照带来的当前像素的漫射颜色量。  像素的漫射颜色模拟光照与粗糙表面的交互方式。 可使用材料环境参数达到近似现实世界中间接光照对某个对象造成外观上的影响的效果。  **输出：**  `Output`: `float4` 间接（即环境）光照带来的当前像素的漫射颜色。 | **访问** 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值** 间接（即环境）光照带来的当前像素的漫射颜色。 |
| **材料漫射**       | 一种颜色，描述当前像素如何漫射直接光照。  像素的漫射颜色模拟光照与粗糙表面的交互方式。 可使用材料漫射参数以更改当前像素漫射直接光照（即定向光、点光和投射光）的方式。  **输出：**  `Output`: `float4` 一种颜色，描述当前像素如何漫射直接光照。 | **访问** 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值** 一种颜色，描述当前像素如何漫射直接光照。 |
| **材料放射**       | 提供自身光线的光照带来的当前像素的颜色量。  可使用它来模拟发光对象，即提供自身光线的对象。 此光线不会影响到其他对象。  **输出：**  `Output`: `float4` 自发光照带来的当前像素的颜色量。 | **访问** 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值** 自发光照带来的当前像素的颜色量。 |
| **材料反射**       | 一种颜色，描述当前像素如何反射直接光照。  像素的反射颜色模拟光照与光滑如镜的表面之间的交互方式。 可使用材料反射参数更改当前像素反射直接光照（即定向光、点光和投射光）的方式。  **输出：**  `Output`: `float4` 一种颜色，描述当前像素如何反射直接光照。 | **访问** 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值** 一种颜色，描述当前像素如何反射直接光照。 |
| **材料光泽度**     | 用于描述反射高光的强度的标量值。  光泽度越强，反射高光则会越强烈并且越深远。  **输出：**  `Output`: `float` 一个指数项，描述当前像素上反射高光的强度。 | **访问** 如果允许从模型编辑器设置属性，则为“公共”；否则为“私有”。  **值** 用于定义当前像素上反射高光的强度的指数。 |
| **标准化时间**     | 以秒为单位的时间，标准化为 [0, 1] 范围，如此一来，当时间达到 1时则会重置为 0。  可将其用作着色器计算中的参数，例如用来对纹理坐标、颜色值或其他属性进行动画处理。  **输出：**  `Output`: `float` 标准化时间，以秒为单位。 | 无                                                           |
| **时间**           | 时间值（以秒计）。  可将其用作着色器计算中的参数，例如用来对纹理坐标、颜色值或其他属性进行动画处理。  **输出：**  `Output`: `float` 时间（以秒为单位）。 |                                                              |

#### [Texture nodes](https://docs.microsoft.com/en-us/visualstudio/designers/texture-nodes?view=vs-2019)

在着色器设计器中，纹理节点采集不同的纹理类型和几何图形样本，并生成或转换纹理坐标。 纹理提供对象的颜色和照明细节。

##### 纹理节点引用

| 节点               | 详细信息                                                     | 属性                                                         |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **立方体贴图样本** | 从立方体贴图中采集指定坐标处的颜色样本。  可使用立方体贴图提供反射效果的颜色细节，或应用到其纹理失真程度低于 2D 纹理的球形对象。  **输入：**  `UVW`: `float3` 一个矢量，指定在纹理立方体上采样的位置。 在采样位置处，此矢量与该立方体相交。  **输出：**  `Output`: `float4` 颜色样本。 | **纹理** 与采样器关联的纹理寄存器。                          |
| **法线贴图样本**   | 从 2D 法线贴图中采集指定坐标处的法线样本  可使用法线贴图模拟对象图面上其他几何细节的外观。 法线贴图包含表示单位矢量的打包数据，而不包含颜色数据  **输入：**  `UV`: `float2` 采样位置的坐标。  **输出：**  `Output`: `float3` 法线样本。 | **坐标轴调整** 用于调整法线贴图样本旋向性的系数。  **纹理** 与采样器关联的纹理寄存器。 |
| **平移 UV**        | 根据时间平移指定的纹理坐标。  可以将此用于在对象图面间移动纹理或法线贴图。  **输入：**  `UV`: `float2` 要平移的坐标。  `Time`: `float` 要进行平移的时长，以秒为单位。  **输出：**  `Output`: `float2` 平移后的坐标。 | **速度 X** 每秒沿 x 轴平移的纹素数。  **速度 Y** 每秒沿 y 轴平移的纹素数。 |
| **视差 UV**        | 根据高度和视角将指定纹理坐标移位。  这样创建的效果被称为*视差映射*，或者虚拟的偏移量映射。 可将此用于在平面图面上创建深度错觉。  **输入：**  `UV`: `float2` 要移位的坐标。  `Height`: `float` 与 `UV` 坐标关联的 heightmap 值。  **输出：**  `Output`: `float2` 移位后的坐标。 | **深度平面** 视差效果的参考深度。 默认情况下，该值为 0.5。 减小此值会提升纹理；增加此值会将纹理降到平面。  **深度数值范围** 视差效果的数值范围。 这在一定程度上断言视深。 典型值介于 0.02 到 0.1 之间。 |
| **旋转 UV**        | 根据时间，围绕中心点旋转指定的纹理坐标。  可以将此用于在对象图面上旋转纹理或法线贴图。  **输入：**  `UV`: `float2` 要旋转的坐标。  `Time`: `float` 要进行平移的时长，以秒为单位。  **输出：**  `Output`: `float2` 旋转后的坐标。 | **中心点 X** 定义旋转中心的 x 坐标。  **中心点 Y** 定义旋转中心的 y 坐标。  **速度** 纹理每秒旋转的角度(弧度形式)。 |
| **纹理坐标**       | 当前像素的纹理坐标。  通过在附近顶点的纹理坐标属性之间插值，决定纹理坐标。 可以将此视为当前像素在纹理空间中的位置。  **输出：**  `Output`: `float2` 纹理坐标。 | 无                                                           |
| **纹理维度**       | 输出 2D 纹理贴图的宽度和高度。  可以使用纹理维度考虑着色器中纹理的宽度和高度。  **输出：**  `Output`: `float2` 纹理的宽度和高度，表示为一个矢量。 宽度存储在矢量的第一个元素中。 高度存储在第二个元素中。 | **纹理** 与纹理维度关联的纹理寄存器。                        |
| **纹素增量**       | 输出 2D 纹理贴图纹素之间的增量（距离）。  可以使用纹素增量对着色器中的相邻纹素值进行采样。  **输出：**  `Output`: `float2` （沿对角线正方向移动的）从某纹素到下一纹素的增量（距离），表示为标准化纹理空间中的矢量。 可以通过有选择地忽略或否定增量的 U 或 V 坐标，获取所有相邻纹素的位置。 | **纹理** 与纹素增量关联的纹理寄存器。                        |
| **纹理样本**       | 从 2D 纹理贴图中采集指定坐标处的颜色样本。  可使用纹理贴图提供对象图面的颜色细节。  **输入：**  `UV`: `float2` 采样位置的坐标。  **输出：**  `Output`: `float4` 颜色样本。 |                                                              |

#### [Math nodes](https://docs.microsoft.com/en-us/visualstudio/designers/math-nodes?view=vs-2019)

在着色器设计器中，数学运算节点执行代数、逻辑、三角函数等其他数学运算。

> 在着色器设计器中使用数学运算节点时，类型提升尤其明显。 若要了解类型提升如何影响输入参数，请参阅[着色器设计器节点](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer-nodes?view=vs-2019)中的“输入提升”部分。

##### 数学运算节点参考

| 节点             | 详细信息                                                     | 属性                                                         |
| ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **Abs**          | 计算每个分量指定输入的绝对值。  对于输入 `X` 的每个分量，负值将被设为正值，使结果的所有分量均为正值。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 用于确定绝对值的值。  `Output:`  `Output`：与输入 `X` 相同 每个分量的绝对值。 | 无                                                           |
| **添加**         | 计算每个分量指定输入的按分量逐位的和。  对于结果的每个分量，会将输入 `X` 和输入 `Y` 的对应分量相加在一起。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要相加的其中一个值。  `Y`：与输入 `X` 相同 要相加的其中一个值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的总和。 | 无                                                           |
| **Ceil**         | 计算每个分量指定输入的上限。  值的上限是大于或等于该值的最小整数。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要计算其上限的值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的上限。 | 无                                                           |
| **限制**         | 将指定输入的每个分量固定在预定义范围内。  对于结果的每个分量，低于定义范围以下的值将被设为该范围中的最小值，超出定义范围的值将被设为该范围中的最大值，处于该范围内的值将保持不变。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要固定其范围的值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的固定值。 | **最大值** 范围内的最大可能值。  **最小值** 范围内的最小可能值。 |
| **Cos**          | 计算每个分量指定输入的余弦（以弧度为单位）。  对于结果的每个分量，将计算对应分量的余弦值（以弧度为单位）。 结果具有值在 [-1, 1] 范围内的分量。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要计算其余弦的值（以弧度为单位）。  **输出：**  `Output`：与输入 `X` 相同 每个分量的余弦。 | 无                                                           |
| **Cross**        | 计算指定的三分量矢量的叉积。  可以使用叉积来计算由两个矢量定义的表面的法线。  **输入：**  `X`: `float3` 叉积左边的矢量。  `Y`: `float3` 叉积右边的矢量。  **输出：**  `Output`: `float3` 叉积。 | 无                                                           |
| **距离**         | 计算指定点之间的距离。  结果为正标量值。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要确定两点之间距离的其中一个点。  `Y`：与输入 `X` 相同 要确定两点之间距离的其中一个点。  **输出：**  `Output`：与输入 `X` 相同 距离。 | 无                                                           |
| **除**           | 计算指定输入的按分量逐个相除的商。  对于结果的每个分量，输入 `X` 的对应分量将除以输入 `Y` 的对应分量。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 被除数值。  `Y`：与输入 `X` 相同 除数值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的商。 | 无                                                           |
| **点**           | 计算指定矢量的点积。  结果为标量值。 可以使用点积来确定两个矢量之间的角度。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 其中一个约分值。  `Y`：与输入 `X` 相同 其中一个约分值。  **输出：**  `Output`: `float` 点积。 | 无                                                           |
| **Floor**        | 计算每个分量指定输入的向下舍入值。  对于结果的每个分量，其值是小于或等于输入的对应分量的最大整数值。 结果的每个分量均为整数。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要计算其向下舍入值的值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的向下舍入值。 | 无                                                           |
| **Fmod**         | 计算指定输入的按分量逐位的模数（余数）。  对于结果的每个分量，将用输入 `X` 的对应分量减去输入 `Y` 的对应分量的一些整数倍数 m，以产生一个余数。 选择倍数 m，使得余数小于输入 `Y` 的对应分量，并且具有与输入 `X` 的对应分量相同的符号。 例如，fmod(-3.14, 1.5) 是 -0.14。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 被除数值。  `Y`：与输入 `X` 相同 除数值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的模数。 | 无                                                           |
| **Frac**         | 删除每个分量指定输入的整数部分。  对于结果的每个分量，输入的对应分量的整数部分将被删除，但会保留小数部分和符号。 该小数值在 [0, 1) 的范围内。 例如，值-3.14 变为值 -0.14。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要计算其小数部分的值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的小数部分。 | 无                                                           |
| **Lerp**         | 线性内插。 计算指定输入的按分量逐位的加权平均值。  对于结果的每个分量，将计算输入 `X` 和输入 `Y` 的对应分量的加权平均值。 权重由 `Percent`提供（一个标量），并统一应用于所有分量。 可以使用它在点、颜色、属性和其他值之间进行内插。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 原始值。 `Percent` 为 0 时，结果等于此输入。  `Y`：与输入 `X` 相同 终端值。 `Percent` 为 1 时，结果等于此输入。  `Percent`: `float` 一个标量权重，以从输入 `X` 到输入 `Y` 的距离的百分比表示。  **输出：**  `Output`：与输入 `X` 相同 一个值，与指定输入共线的值。 | 无                                                           |
| **乘加**         | 计算指定输入的按分量逐位的乘加。  对于结果的每个分量，输入 `M` 和 `A` 的对应分量的积将被添加到输入 `B` 的对应分量中。 可在常见公式（例如，线的点斜率公式和缩放的公式）中找到此操作顺序，然后偏差输入。  **输入：**  `M`：`float`、`float2`、`float3` 或 `float4` 要一起相乘的其中一个值。  `A`：与输入 `M` 相同 要一起相乘的其中一个值。  `B`：与输入 `M` 相同 要添加到其他两个输入的积中的值。  **输出：**  `Output`：与输入 `M` 相同 每个分量的乘加的结果。 | 无                                                           |
| **最大值**       | 计算指定输入的按分量逐位的最大值。  对于结果的每个分量，将选取输入的对应分量中的较大者。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要计算最大值的其中一个值。  `Y`：与输入 `X` 相同 要计算最大值的其中一个值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的最大值。 | 无                                                           |
| **最小值**       | 计算指定输入的按分量逐位的最小值。  对于结果的每个分量，将选取输入的对应分量中的较小者。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要计算最小值的其中一个值。  `Y`：与输入 `X` 相同 要计算最小值的其中一个值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的最小值。 | 无                                                           |
| **相乘**         | 计算指定输入的按分量逐位的积。  对于结果的每个分量，输入 `X` 和输入 `Y` 的对应分量将全部相乘。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要一起相乘的其中一个值。  `Y`：与输入 `X` 相同 要一起相乘的其中一个值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的积。 | 无                                                           |
| **标准化**       | 对指定矢量进行标准化。  标准化矢量将保留原始矢量的方向，但不保留其量值。 可以使用标准化矢量来简化矢量的量值在其中不重要的计算。  **输入：**  `X`：`float2`、`float3` 或 `float4` 要规范化的向量。  **输出：**  `Output`：与输入 `X` 相同 规范化的向量。 | 无                                                           |
| **一减**         | 计算 1 和每个分量指定输入之间的差。  对于结果的每个分量，将从 1 中减去输入的对应分量。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要从 1 中减去的值。  **输出：**  `Output`：与输入 `X` 相同 1 和每个分量指定输入之间的差。 | 无                                                           |
| **幂**           | 计算指定输入的按分量逐位的幂。  对于结果的每个分量，以输入 `X` 对应分量为底数，以输入 `Y` 的对应分量为指数进行幂运算。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 基数值  `Y`：与输入 `X` 相同 指数值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的幂。 | 无                                                           |
| **饱和**         | 将指定输入的每个分量固定在范围 [0, 1] 内。  可以使用此范围表示计算中的百分比和其他相对度量。 对于结果的每个分量，小于 0 的对应分量值将被设为等于 0。大于 1 的对应分量值将被设为等于 1，处于该范围内的值将保持不变。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要饱和的值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的饱和值。 | 无                                                           |
| **Sin**          | 计算每个分量指定输入的正弦值（以弧度为单位）。  对于结果的每个分量，将计算对应分量的正弦值（以弧度为单位）。 结果具有值在 [-1,1] 范围内的分量。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要计算其正弦的值（以弧度为单位）。  **输出：**  `Output`：与输入 `X` 相同 每个分量的正弦。 | 无                                                           |
| **Sqrt**         | 计算每个分量指定输入的平方根。  对于结果的每个分量，将计算对应分量的平方根。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要计算其平方根的值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的平方根。 | 无                                                           |
| **相减**         | 计算指定输入的按分量逐位的差。  对于结果的每个分量，将从输入 `X` 的对应分量中减去输入 `Y` 的对应分量。 可以使用它来计算从第一个输入延伸到第二个输入的矢量。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要从中减去值的值。  `Y`：与输入 `X` 相同 要从输入 `X` 中减去的值。  **输出：**  `Output`：与输入 `X` 相同 每个分量的差。 | 无                                                           |
| **转换三维向量** | 将指定的 3D 向量转换到不同的空间中。  可以使用它将点或向量放入到公共空间中，以便使用它们执行有意义的计算。  **输入：**  `Vector`: `float3` 要转换的向量。  **输出：**  `Output`: `float3` 转换后的向量。 | **源系统** 矢量的本机空间。  **目标系统** 要将矢量转换到的空间。 |

#### [Utility nodes](https://docs.microsoft.com/en-us/visualstudio/designers/utility-nodes?view=vs-2019)

在着色器设计器中，实用程序节点表示不适合归入其他类别的常见且有用的着色器计算。 某些实用程序节点执行简单的操作，如将矢量追加在一起或有条件地选择结果；其他节点执行复杂的操作，如根据常用的照明模型计算照明量。

##### 实用程序节点引用

| 节点         | 详细信息                                                     | 属性                                                         |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **追加矢量** | 通过将指定的输入追加在一起，创建矢量。  **输入：**  `Vector`：`float`、`float2` 或 `float3` 要追加到其中的值。  `Value to Append`: `float` 要追加的值。  **输出：**  `Output`：`float2`、`float3` 或 `float4`，具体取决于输入 `Vector` 的类型 新的矢量。 | 无                                                           |
| **菲涅耳**   | 基于指定的表面法线计算菲涅耳衰减。  菲涅耳衰减值表示当前像素的表面法线与视图矢量的一致程度。 在矢量对齐时，函数的结果为 0；矢量越不相似，结果越大，且当矢量正交时，达到其最大值。 可将此用于基于当前像素的方向和照相机之间的关系，生成更清晰或更模糊的效果。  **输入：**  `Surface Normal`: `float3` 当前像素的表面法线，在当前像素的切线空间中定义。 可将此用于干扰明显的表面法线，如法线贴图所示。  **输出：**  `Output`: `float` 当前像素的反射率。 | **指数** 用于计算菲涅尔衰减的指数。                          |
| **如果**     | 有条件地选择每个分量的三个可能结果之一。 该条件由两个其他指定输入之间的关系来定义。  对于结果的每个分量，将根据前两个输入的对应分量之间的关系选择三个可能结果之一的对应分量。  **输入：**  `X`：`float`、`float2`、`float3` 或 `float4` 要比较的左侧值。  `Y`：与输入 `X` 类型相同 要比较的右侧值。  `X > Y`：与输入 `X` 类型相同 在 `X` 大于 `Y` 时所选的值。  `X = Y`：与输入 `X` 类型相同 在 `X` 等于 `Y` 时所选的值。  `X < Y`：与输入 `X` 类型相同 在 `X` 小于 `Y` 时所选的值。  **输出：**  `Output`: `float3` 对每个分量所选的结果。 | 无                                                           |
| **朗伯**     | 通过使用指定的表面法线，根据朗伯照明模型计算当前像素的颜色。  该颜色是直接照明下，环境颜色和漫射照明量的总和。 环境颜色近似于间接照明的总量，但如果没有其他照明的帮助，看起来单调且平淡。 漫射照明有助于向对象添加形状和深度。  **输入：**  `Surface Normal`: `float3` 当前像素的表面法线，在当前像素的切线空间中定义。 可将此用于干扰明显的表面法线，如法线贴图所示。  `Diffuse Color`: `float3` 当前像素的漫射颜色，通常为**点颜色**。 如果未提供任何输入，则默认值为白色。  **输出：**  `Output`: `float3` 当前像素的漫射颜色。 | 无                                                           |
| **遮罩向量** | 指定矢量的遮罩分量。  可将此用于从某个颜色值中移除特定颜色通道，或阻止特定分量对后续计算产生影响。  **输入：**  `Vector`: `float4` 要遮罩的矢量。  **输出：**  `Output`: `float4` 已遮罩的矢量。 | **红色/X** 若要遮住红色 (x) 分量，则为 **False**；否则为 **True**。  **绿色/Y** 若要遮住绿色 (y) 分量，则为 **False**；否则为 **True**。  **蓝色/Z** 若要遮住蓝色 (z) 分量，则为 **False**；否则为 **True**。  **Alpha/W** 若要遮住 alpha (w) 分量，则为 **False**；否则为 **True**。 |
| **反射矢量** | 基于照相机的位置，计算正切空间中当前像素的反射矢量。  可以将此用于计算反射、立方体贴图坐标和反射照明量  **输入：**  `Tangent Space Surface Normal`: `float3` 当前像素的表面法线，在当前像素的切线空间中定义。 可将此用于干扰明显的表面法线，如法线贴图所示。  **输出：**  `Output`: `float3` 反射矢量。 | 无                                                           |
| **反射**     | 通过使用指定的表面法线，根据 Phong 照明模型计算反射照明量。  反射照明赋予对象（例如水、塑料或金属）闪亮、反光的外观。  **输入：**  `Surface Normal`: `float3` 当前像素的表面法线，在当前像素的切线空间中定义。 可将此用于干扰明显的表面法线，如法线贴图所示。  **输出：**  `Output`: `float3` 反射高光的颜色量。 |                                                              |

#### [Filter nodes](https://docs.microsoft.com/en-us/visualstudio/designers/filter-nodes?view=vs-2019)

在着色器设计器中，筛选节点会将输入（如颜色或纹理样本）转换为形象的颜色值。 这些形象的颜色值通常用于非真实感渲染或用作其他视觉效果的分量。

##### 筛选节点引用

| 节点           | 详细信息                                                     | 属性                                                    |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------- |
| **模糊**       | 通过高斯函数模糊纹理中的像素。  它可用于减少纹理中的颜色细节或干扰。  **输入：**  `UV`: `float2` 要测试的纹素坐标。  **输出：**  `Output`: `float4` 经过模糊处理的颜色值。 | **纹理** 与模糊过程中使用的采样器关联的纹理寄存器。     |
| **去除饱和度** | 减少指定颜色的颜色量。  删除颜色后，该颜色值将近似于其灰度等效值。  **输入：**  `RGB`: `float3` 要去除饱和度的颜色。  `Percent`: `float` 要删除的颜色百分比，以范围 [0, 1] 中的标准值表示。  **输出：**  `Output`: `float3` 去除饱和度的颜色。 | **亮度** 为红色、绿色和蓝色分量指定的权重。             |
| **边缘检测**   | 使用 Canny 边缘检测程序检测纹理中的边缘。 边缘像素输出为白色；非边缘像素输出为黑色。  它可用于识别纹理中的边缘，以便可使用其他效果处理边缘像素。  **输入：**  `UV`: `float2` 要测试的纹素坐标。  **输出：**  `Output`: `float4` 如果纹素位于边缘，则为白色；否则为黑色。 | **纹理** 与边缘检测过程中使用的采样器关联的纹理寄存器。 |
| **锐化**       | 锐化纹理。  它可用于突出显示纹理中的细节。  **输入：**  `UV`: `float2` 要测试的纹素坐标。  **输出：**  `Output`: `float4` 经过模糊处理的颜色值。 |                                                         |

### [Shader designer examples](https://docs.microsoft.com/en-us/visualstudio/designers/shader-designer-examples?view=vs-2019)

本节文档中的文章包含演示如何使用着色器设计器创建各种图形效果的示例。

#### 相关主题

|                                                              |                                                              |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [如何：创建基本颜色着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-color-shader?view=vs-2019) | 演示将常量颜色应用于对象的着色器。                           |
| [如何：创建基本 Lambert 着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-lambert-shader?view=vs-2019) | 演示将经典朗伯照明模型应用于对象的着色器。                   |
| [如何：创建基本 Phong 着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-phong-shader?view=vs-2019) | 演示将经典 Phong 照明模型应用于对象的着色器。                |
| [如何：创建基本纹理着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-texture-shader?view=vs-2019) | 演示将纹理应用于对象的着色器。                               |
| [如何：创建灰度纹理着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-grayscale-texture-shader?view=vs-2019) | 演示在呈现期间将纹理转换为灰度并将其应用于对象的着色器。     |
| [如何：创建基于几何图形的渐变着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-geometry-based-gradient-shader?view=vs-2019) | 演示基于对象的几何图形调制颜色，并将其应用于该对象的着色器。 |
| [演练：创建真实的三维台球](https://docs.microsoft.com/zh-cn/visualstudio/designers/walkthrough-creating-a-realistic-3-d-billiard-ball?view=vs-2019) | 演示如何结合着色器技术和纹理资源以创建真实的台球着色器。     |
| [如何：导出着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-shader?view=vs-2019) | 说明如何以应用可使用的格式导出 DGSL 着色器。                 |

#### [Create a basic color shader](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-a-basic-color-shader?view=vs-2019)

本文演示如何使用着色器设计器和定向关系图着色器语言 (DGSL) 创建平面颜色着色器。 此着色器将最终颜色设置为常量 RGB 颜色值。

###### 创建平面颜色着色器

可将 RGB 颜色常量的颜色值写入最终输出颜色来实现平面颜色着色器。

开始前，请确保显示“属性”窗口和“工具箱”。

1. 创建要使用的 DGSL 着色器。 若要了解如何向项目添加 DGSL 着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“入门”部分。
2. 删除“点颜色”节点。 使用“选择”工具选择“点颜色”节点，然后在菜单栏上选择“编辑” > “删除”。
3. 将“颜色常量”节点添加到关系图。 在“常量”的“工具箱”中，选择“颜色常量”，然后将其移到设计图面。
4. 为“颜色常量”节点指定颜色值。 使用“选择”工具选择“颜色常量”节点，然后在“属性”窗口的“输出”属性中指定颜色值。 为橙色指定 (1.0, 0.5, 0.2, 1.0) 中的值。
5. 将颜色常量连接到最终颜色。 若要创建连接，请将“颜色常量”节点的“RGB”终端移到“最终颜色”节点的“RGB”终端，然后将“颜色常量”节点的“Alpha”终端移到“最终颜色”节点的“Alpha”终端。 这些连接将最终颜色设置为上一步中定义的颜色常量。

下图显示了已完成的着色器关系图和应用于立方体的着色器预览。

Note

在图中，指定橙色以更好地展示着色器的效果。

![三维模型上的着色器图及其结果](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-flat-color-effect.png?view=vs-2019)

某些形状可能会增强某些着色器的预览效果。 若要深入了解如何在着色器设计器中预览着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)。

#### [Create a basic Lambert shader](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-a-basic-lambert-shader?view=vs-2019)

本文演示如何使用着色器设计器和定向关系图着色器语言 (DGSL) 创建实现经典朗伯照明模型的照明着色器。

##### 朗伯照明模型

朗伯照明模型将环境照明和方向照明应用到三维场景中的阴影对象。 环境分量在三维场景中提供基本照明级别。方向分量提供来自定向（远）光源的额外照明。 环境照明会均匀影响场景中的所有表面，而不考虑其方向。 对于给定表面，它是表面的环境色和场景中环境照明的颜色和强度的结合产物。 定向照明根据相对于光源方向的表面方向，以不同方式影响场景中的每个表面。 它是表面的漫射颜色和方向，以及光源的颜色、强度和方向生成的结果。 直接面向光源的表面接收比例最大，直接背对的表面无接收比例。 在朗伯照明模型下，会结合环境分量和一个或多个定向分量来确定对象上每个点的总漫射颜色比例。

开始前，请确保显示“属性”窗口和“工具箱”。

1. 创建要使用的 DGSL 着色器。 若要了解如何向项目添加 DGSL 着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“入门”部分。

2. 从“最终颜色”节点断开“点颜色”节点。 选择“点颜色”节点的“RGB”终端，然后选择“断开链接”。 让“Alpha”终端保持连接状态。

3. 向关系图添加“朗伯”节点。 在“工具箱”中的“实用工具”下选择“朗伯”，然后将其移到设计图面。 朗伯节点基于环境和漫射照明参数计算像素的总漫射颜色比例。

4. 将“点颜色”节点连接到“朗伯”节点。 在“选择”模式下，将“点颜色”节点的“RGB”终端移到“朗伯”节点的“漫射颜色”终端。 此连接为朗伯节点提供了像素的内插漫射颜色。

5. 将计算得出的颜色值连接到最终颜色。 将“朗伯”节点的“输出”终端移到“最终颜色”节点的“RGB”终端。

   下图显示了已完成的着色器关系图和应用于茶壶体的着色器预览。

> 为了更好地演示该图着色器的效果，使用着色器的 **MaterialDiffuse** 参数指定了橙色。 游戏或应用可使用此参数为每个对象提供唯一的颜色值。 有关材质参数的信息，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“预览着色器”部分。

![着色器关系图和其效果的预览。](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-lambert-effect-graph.png?view=vs-2019)

某些形状可能会增强某些着色器的预览效果。 若要深入了解如何在着色器设计器中预览着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“预览着色器”部分。

下图显示了本文档中所述的应用于三维模型的着色器。

![应用于模型的 Lambert 照明。](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-lambert-effect-result.png?view=vs-2019)

有关如何向三维模型应用着色器的详细信息，请参阅[如何：向三维模型应用着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-apply-a-shader-to-a-3-d-model?view=vs-2019)。

#### [Create a basic Phong shader](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-a-basic-phong-shader?view=vs-2019)

本文演示如何使用着色器设计器和定向关系图着色器语言 (DGSL) 创建实现经典冯氏照明模型的照明着色器。

##### 冯氏照明模型

冯氏照明模型扩展了朗伯照明模型，包括可反射图面属性的镜面高光。 反射分量提供用于朗伯照明模型的相同定向光源的其他照明，但是会以不同的方式处理其对最终颜色的比例。 镜面高光根据视图方向、光源方向和表面方向之间的关系，以不同的方式影响场景中的每个表面。 它是表面的反射颜色、反射强度和方向，以及光源的颜色、强度和方向共同产生的结果。 在观察者处直接反射光源的表面接收最大反射比例，反射远离观察者的光源的表面无接收比例。 在冯氏照明模型下，将结合一个或多个反射分量来确定对象上每个点的镜面高光颜色和强度，然后将其添加到朗伯照明模型的结果上以产生像素的最终颜色。

有关 Lambert 光照模型的详细信息，请参阅[如何：创建基本 Lambert 着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-lambert-shader?view=vs-2019)。

开始前，请确保显示“属性”窗口和“工具箱”。

1. 按[如何：创建基本 Lambert 着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-lambert-shader?view=vs-2019)。

2. 从“最终颜色”节点断开“朗伯”节点。 选择“朗伯”节点的“RGB”终端，然后选择“断开链接”。 这为在下一步中添加的节点腾出空间。

3. 向关系图添加“添加”节点。 在“工具箱”中的“数学”下选择“添加”，然后将其移到设计图面。

4. 向关系图添加“反射”节点。 在“工具箱”中的“实用工具”下，选择“反射”，然后将其移到设计图面。

5. 添加反射比例。 将“反射”节点的“输出”终端移到“添加”节点的“X”终端，然后将“朗伯”节点的“输出”终端移到“添加”节点的“Y”终端。 这些连接会组合像素的总漫射比例和总反射颜色比例。

6. 将计算得出的颜色值连接到最终颜色。 将“添加”节点的“输出”终端移到“最终颜色”节点的“RGB”终端。

   下图显示了已完成的着色器关系图和应用于茶壶体的着色器预览。

Note

为了更好地演示该图中着色器的效果，使用着色器的 **MaterialDiffuse** 参数指定了橙色，并使用 **MaterialSpecular**和 **MaterialSpecularPower** 参数指定了金属外观。 有关材质参数的信息，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“预览着色器”部分。

![着色器图及其效果预览](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-lighting-graph.png?view=vs-2019)

某些形状可能会增强某些着色器的预览效果。 若要深入了解如何在着色器设计器中预览着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“预览着色器”部分

下图显示了本文档中所述的应用于三维模型的着色器。 **MaterialSpecular** 属性设置为 (1.00, 0.50, 0.20, 0.00)，并将其 **MaterialSpecularPower** 属性设置为 16。

Note

**MaterialSpecular** 属性确定表面材质的表面光洁度。 高光泽表面（如玻璃或塑料）往往具有白色明亮阴影的反射颜色。 金属表面往往具有接近其漫射颜色的反射颜色。 缎面表面往往具有深灰色的反射颜色。

**MaterialSpecularPower** 属性确定高光的强度。 高反射强度模拟更暗淡、更局部化的高光效果。 较低的反射强度模拟大幅度的强烈高光，其可能会过度饱和并遮掩整个表面的颜色。

![应用于模型的 Phong 照明](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-lighting-model.png?view=vs-2019)

有关如何向三维模型应用着色器的详细信息，请参阅[如何：向三维模型应用着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-apply-a-shader-to-a-3-d-model?view=vs-2019)。

#### [Create a basic texture shader](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-a-basic-texture-shader?view=vs-2019)

本文演示如何使用着色器设计器和定向关系图着色器语言 (DGSL) 创建单纹理着色器。 此着色器直接将最终颜色设置为从纹理中采样的 RGB 和 alpha 值。

##### 创建基本纹理着色器

可通过将纹理样本的颜色和 alpha 值直接写入最终输出颜色，实现基本的单纹理着色器。

开始前，请确保显示“属性”窗口和“工具箱”。

1. 创建要使用的 DGSL 着色器。 若要了解如何向项目添加 DGSL 着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“入门”部分。
2. 删除“点颜色”节点。 在“选择”模式下，选择“点颜色”节点，然后在菜单栏上选择“编辑” > “删除”。 这为在下一步中添加的节点腾出空间。
3. 将“纹理样本”节点添加到关系图。 在“工具箱”中的“纹理”下选择“纹理样本”，然后将其移到设计图面。
4. 将“纹理坐标”节点添加到关系图。 在“工具箱”中的“纹理”下选择“纹理坐标”，然后将其移到设计图面。
5. 选择要应用的纹理。 在“选择”模式中，选择“纹理样本”节点，然后在“属性”窗口中通过“文件名”属性指定要使用的纹理。
6. 使纹理可公开访问。 选择“纹理样本”节点，然后在“属性”窗口中将“访问”属性设置为“公共”。 现可利用其他工具（如**模型编辑器**）设置纹理。
7. 将纹理坐标连接到纹理样本。 在“选择”模式下，将“纹理坐标”节点的“输出”终端移到“纹理样本”节点的“UV”终端。 此连接在指定坐标处对纹理进行采样。
8. 将纹理样本连接到最终颜色。 将“纹理示例”节点的“RGB”终端移到“最终颜色”节点的“RGB”终端，然后将“纹理示例”节点的“Alpha”终端移到“最终颜色”节点的“Alpha”终端。

下图显示了已完成的着色器关系图和应用于立方体的着色器预览。

Note

在此插图中，飞机用作预览形状，并且已指定一个纹理以更好地演示着色器的效果。

![着色器图及其效果预览](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-texture-effect.png?view=vs-2019)

某些形状可能会增强某些着色器的预览效果。 若要深入了解如何在着色器设计器中预览着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)

#### [Create a grayscale texture shader](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-a-grayscale-texture-shader?view=vs-2019)

本文演示如何使用着色器设计器和有向图着色器语言 (DGSL) 创建灰度纹理着色器。 此着色器将修改纹理样本的 RGB 颜色值，然后将其与未修改的 Alpha 值一起用于设置最终颜色。

##### 创建灰度纹理着色器

可以通过在将纹理样本写入最终输出颜色之前修改纹理样本的颜色值来实现灰度纹理着色器。

开始前，请确保显示“属性”窗口和“工具箱”。

1. 按[如何：创建基本纹理着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-texture-shader?view=vs-2019)中所述创建基本纹理着色器。

2. 从“最终颜色”节点的“RGB”终端断开“纹理示例”节点的“RGB”终端。 在“选择”模式中，选择“纹理示例”节点的“RGB”终端，然后选择“断开链接”。 这为在下一步中添加的节点腾出空间。

3. 向图添加“去除饱和度”节点。 在“工具箱”中的“文件”，选择“去除饱和度”，然后将其移到设计图面。

4. 使用“去除饱和度”节点计算灰度值。 在“选择”模式中，将“纹理样示例”节点的“RGB”终端移到“去除饱和度”节点的“RGB”终端。

   Note

   默认情况下，“去除饱和度”节点完全去除输入颜色的饱和度，并使用标准亮度权重进行灰度转换。 可以通过更改“亮度”属性的值或仅部分去除输入颜色的饱和度来更改“去除饱和度”节点的行为方式。 若要部分去除输入颜色的饱和度，请向“去除饱和度”节点的“百分比”终端提供 [0,1) 范围中的标量值。

5. 将灰度颜色值连接到最终颜色。 将“去除饱和度”节点的“输出”终端移到“最终颜色”节点的“RGB”终端。

下图显示了已完成的着色器关系图和应用于立方体的着色器预览。

> 在此插图中，飞机用作预览形状，并且已指定一个纹理以更好地演示着色器的效果。

![着色器图及其效果预览](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-grayscale-effect.png?view=vs-2019)

某些形状可能会增强某些着色器的预览效果。 有关在着色器设计器中预览着色器的详细信息，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)

#### [Create a geometry-based gradient shader](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-create-a-geometry-based-gradient-shader?view=vs-2019)

本文演示如何使用着色器设计器和定向关系图着色器语言创建基于几何图形的渐变着色器。 此着色器将常量 RGB 颜色值按照世界空间中对象的每个点的高度进行缩放。

##### 创建基于几何图形的渐变着色器

您可以通过将像素的位置并入着色器中来实现基于几何图形的着色器。 在着色语言中，除了 2D 屏幕上的颜色和位置之外，像素还包含其他信息。 像素（在某些系统中称为片段）是值的一个集合，描述对应于像素的图面。 本文档中描述的着色器利用全局空间中三维对象的每个像素的高度，来影响片段的最终输出颜色。

开始前，请确保显示“属性”窗口和“工具箱”。

1. 创建要使用的 DGSL 着色器。 若要了解如何向项目添加 DGSL 着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“入门”部分。
2. 从“最终颜色”节点断开“点颜色”节点。 选择“点颜色”节点的“RGB”终端，然后选择“断开链接”。 这为在下一步中添加的节点腾出空间。
3. 向关系图添加“乘法”节点。 在“工具箱”中的“数学”下，选择“乘法”，然后将其移到设计图面。
4. 向关系图添加“遮罩向量”节点。 在“工具箱”中的“实用工具”下，选择“遮罩向量”，然后将其移到设计图面。
5. 为“遮罩向量”节点指定掩码值。 在“选择”模式中，选择“遮罩向量”节点，然后在“属性”窗口中，将“绿色/Y”属性设置为“True”，并将“红色/X”、“蓝色/Z”和“Alpha / W”属性设置为“False”。 在此示例中，“红色/X”、“绿色/Y”和“蓝色/Z”属性对应于“世界位置”节点的 x、y 和 z 分量，并且不使用“Alpha / W”。 由于仅将“绿色/Y”设置为“True”，因此在遮盖它后，仅保留输入向量的 y 分量。
6. 向关系图添加“世界位置”节点。 在“工具箱”中的“常量”下，选择“世界位置”，然后将其移到设计图面。
7. 掩盖片段的世界空间位置。 在“选择”模式中，将“世界位置”的“输出”终端移到“遮罩向量”节点的“矢量”终端。此连接会掩盖片段的位置以忽略 x 和 z 分量。
8. 将 RGB 颜色常量乘以遮罩的世界空间位置。 将“点颜色”节点的“RGB”终端移到“乘法”节点的“Y”终端，然后将“遮罩向量”节点的“输出”终端移到“乘法”节点的“X”终端。 此连接按全局空间中的像素高度缩放颜色值。
9. 将缩放的颜色值连接到最终颜色。 将“乘法”节点的“输出”终端移到“最终颜色”节点的“RGB”终端。

下图显示了已完成的着色器关系图和应用于球体的着色器预览。

> 在此图中，指定了橙色以更好地演示着色器的效果，但因为预览形状在世界空间中没有位置，所以无法在着色器设计器中完全预览该着色器。 必须在实际场景中预览着色器以演示完全效果。

![着色器图及其效果预览](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-gradient-effect-graph.png?view=vs-2019)

某些形状可能会增强某些着色器的预览效果。 有关如何在着色器设计器中预览着色器的详细信息，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“预览着色器”

下图显示了应用于在[如何：构建三维地形模型](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-model-3-d-terrain?view=vs-2019)中演示的三维场景的着色器（此着色器为本文档中所述的着色器）。颜色的强度随着世界中点的高度而增加。

![应用于三维地形模型的渐变效果](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/digit-gradient-effect-result.png?view=vs-2019)

有关如何向三维模型应用着色器的详细信息，请参阅[如何：向三维模型应用着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-apply-a-shader-to-a-3-d-model?view=vs-2019)。

#### [Walkthrough: Create a realistic 3D billiard ball](https://docs.microsoft.com/en-us/visualstudio/designers/walkthrough-creating-a-realistic-3-d-billiard-ball?view=vs-2019)

本演练演示如何使用 Visual Studio 中的着色器设计器和图像编辑器创建真实的三维台球。 将几项着色技术与合适的纹理资源合并，实现台球的三维效果。

##### 系统必备

需以下组件和技能来完成本演练：

- 用于将纹理组合成立方体贴图的工具，例如 2010 年 6 月的 DirectX SDK 中包含的 DirectX 纹理工具。
- 熟悉 Visual Studio 中的图像编辑器。
- 熟悉 Visual Studio 中的着色器设计器。

##### 使用形状和纹理创建基本外观

在计算机图形中，外观的最基本元素是形状和颜色。 在计算机模拟中，通常使用三维模型来表示真实世界物体的形状。 然后使用纹理贴图将颜色细节应用到模型表面。

通常情况下，可能需要让艺术家创建一个可使用的三维模型，但是由于台球形状很常见（球体），所以着色器设计器内置有合适的模型。

着色器设计器中默认预览形状为球体；如果正使用其他形状预览着色器，请切换回球体。

###### 使用球体预览着色器

- 在着色器设计器工具栏上，选择“用球体预览”。

下一步，将创建一个将纹理应用到模型的着色器程序，但在此之前必须先创建一个可使用的纹理。 本演练演示如何使用 Visual Studio 中的图像编辑器创建纹理，但用户也可以使用任何能够以适当格式保存纹理的图像编辑器。

请确保显示“属性”窗口和“工具箱”。

###### 使用图像编辑器创建台球纹理

1. 创建要使用的纹理。 有关如何向项目中添加纹理的信息，请参阅[图像编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019)中的“入门”部分。

2. 设置图像尺寸，将宽度设置为高度的两倍；这一步必不可少，因为要考虑将纹理映射到台球球面的方式。 若要调整图像大小，请在“属性”窗口为“宽度”和“高度”属性指定新值。 例如，将宽度设置为 512，高度设置为 256。

3. 绘制台球的纹理，请记住将纹理映射到球体的方式。

   纹理应如下所示：

   ![台球的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_art_ball_texture.png?view=vs-2019)

4. 或者，可能会希望减少此纹理的存储要求。 可根据纹理高度减小其宽度来实现此操作。 这会压缩宽度上的纹理，但是由于纹理映射到球体的方式，当呈现台球时，会展开纹理。 重新设置大小后，纹理应如下所示：

   ![压缩为正方形的台球纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_art_ball_texture_square.png?view=vs-2019)

   现可创建一个将该纹理应用于模型的着色器。

###### 创建基本纹理着色器

1. 创建要使用的 DGSL 着色器。 若要了解如何向项目添加 DGSL 着色器，请参阅[着色器设计器](https://docs.microsoft.com/zh-cn/visualstudio/designers/shader-designer?view=vs-2019)中的“入门”部分。

   默认情况下，着色器图如下所示：

   ![默认着色器关系图](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_step_0.png?view=vs-2019)

2. 修改默认着色器，将纹理样本的值应用于当前像素。 着色器图应如下所示：

   ![将纹理应用于对象的着色器关系图](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_step_1.png?view=vs-2019)

3. 通过配置纹理属性，应用在上一个过程中创建的纹理。 将“纹理样本”节点的“纹理”属性的值设置为“纹理 1”，然后使用同一属性窗口中的“纹理 1”属性组的“文件名”属性指定纹理文件。

   有关如何在着色器中应用纹理的详细信息，请参阅[如何：创建基本纹理着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-texture-shader?view=vs-2019)。

   台球现应如下所示：

   ![带纹理的台球的特写](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_.png?view=vs-2019)

##### 使用朗伯照明模型创建深度

到目前为止，已创建一个易于辨认的台球。 但它看起来扁平无趣，更像是台球卡通图片，而不是仿真复制品。 过于简单的着色器产生扁平的外观，就好像台球表面的每个像素接收到同样多的光照。

在现实世界中，直接面向光源的表面上的光线最亮，与光源成倾角的表面上的光线稍暗。 这是因为表面直接面向光源时，光线中的能量在表面上的分布面积最小。 表面不直接面向光源时，相同的能量在表面上的分布面积变大。 背向光源的表面完全不接收光线能量，所以出现黑暗面。 物体表面的亮度差异是重要的视觉提示，有助于表示物体形状；没有亮度差异，物体就没有立体感。

在计算机图形中，“照明模型”简化了模拟复杂真实的照明互动，可用于复制真实照明。 朗伯照明模型改变了物体表面漫反射光照量，如上一段所述。 可将朗伯照明模型添加到着色器中，使台球的三维外观更加逼真。

###### 将朗伯照明添加到着色器

- 修改着色器，根据朗伯照明值调整纹理样本值。 着色器图应如下所示：

  ![添加了 Lambert 照明的着色器关系图](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_step_2.png?view=vs-2019)

- 或者也可通过配置着色器图的 MaterialDiffuse 属性来调整照明的呈现方式。 若要访问着色器图的属性，请选择设计表面的空白区域，然后在“属性”窗口中找到要访问的属性。

有关如何在着色器中应用 Lambert 光照的详细信息，请参阅[如何：创建基本 Lambert 着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-lambert-shader?view=vs-2019)。

使用朗伯照明后，台球应如下所示：

![带纹理的照亮的台球的特写](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_ball_2.png?view=vs-2019)

##### 使用反射高光增强基本外观

朗伯照明模型提供形状和维度感，在仅有纹理的着色器中无法实现这一点。 但此时台球外表仍较暗淡。

真正的桌球表面通常具有光泽，可反射照在其上的部分光线。 这些反射光线产生反射高光，模拟表面的反射属性。 根据表面的属性，高亮可以是局部的或广泛的，也可以是强烈的或细微的。 根据光源、表面方向和相机位置之间的关系为镜面反射建模，也就是说，当表面方向直接将光源反射到相机时，高光最强；间接反射时，高光则较弱。

冯氏照明模型建立在朗伯照明模型的基础上，包含上一段所述的反射高光。 可将冯氏照明模型添加到着色器，赋予台球模拟的表面效果，使外观更有趣。

###### 将反射高光添加到着色器

1. 使用添加混合修改着色器以包含反射部分。 着色器图应如下所示：

   ![添加了反射照明的着色器关系图](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_step_3.png?view=vs-2019)

2. 或者也可配置着色器图的反射属性（“MaterialSpecular”和“MaterialSpecularPower”），调整反射高光的呈现方式。 若要访问着色器图的属性，请选择设计表面的空白区域，然后在“属性”窗口中找到要访问的属性。

   有关如何在着色器中应用镜面高光的详细信息，请参阅[如何：创建基本 Phong 着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-phong-shader?view=vs-2019)。

   应用反射照明后，台球应如下所示：

   ![添加了反射的台球的特写](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_ball_3.png?view=vs-2019)

##### 通过反射环境创造空间感

应用反射高光后，台球看起来很逼真。 形状、漆面和表面效果都恰到好处。 但还有一种技术可使台球与环境融为一体。

如果仔细观察真正的台球，就会看到其光亮的表面不仅仅呈现反射高光，而且还会隐约地反映周围的影像。 通过将环境影像作为纹理与模型自身纹理相结合，确定每个像素最终的颜色，可以模拟此反射。 你可以适当的反射纹理与着色器的其余部分结合，具体取决于希望得到哪种类型的表面效果。 例如，如果着色器模拟像镜子一样的高度反光的表面，则可能只使用反射纹理；但如果着色器模拟像桌球一样比较轻微的反射，则可能要将一小部分反射纹理值与着色器计算的其余部分相结合。

当然，不能仅仅照搬应用模型的纹理映射的方式将反射贴图应用到模型。 如果这样做，环境的反射就会随台球一起移动，就像粘在台球上一样。 由于发出反射的方向不定，因此需要能够提供各个角度的反射贴图值，并能够根据环境保持反射贴图朝向。 若要满足这些要求，可使用一种名为“立方体贴图”的特殊纹理贴图，该纹理贴图有 6 种纹理，可排列构成立方体的各个面。 可从此立方体内部指向任意方向，找出纹理值。 如果立方体每个面的纹理都包含环境影像，则可对立方体表面的适当位置进行采样，模拟反射。 通过将立方体与环境对准，即可获得准确的环境反射。 若要确定立方体上的采样位置，只需计算相机向量从物体表面的反射，然后将其用作三维纹理坐标。 以这种方式使用立方体贴图是一种常见的技术，该技术称为“环境映射”。

如之前段落所述，环境映射高效地模拟了真实反射。 你可以将环境映射的反射混合到着色器中，赋予台球模拟的表面效果，使台球更好地融入场景。

第一步，创建立方体贴图纹理。 在许多应用中，立方体贴图的内容无需绝对有效，特别是当反射较轻微时，或未占据屏幕的大部分空间时。 例如，许多游戏使用预先计算的立方体贴图进行环境映射，且仅使用最接近每个反光物体的贴图，尽管这意味着反射并不正确。 即使是粗略模拟通常也足以实现逼真的效果。

###### 使用图像编辑器为环境映射创建纹理

1. 创建要使用的纹理。 有关如何向项目中添加纹理的信息，请参阅[图像编辑器](https://docs.microsoft.com/zh-cn/visualstudio/designers/image-editor?view=vs-2019)中的“入门”部分。

2. 设置图像尺寸，使其宽度等于其高度，尺寸为二的幂次方；这一步必不可少，因为要考虑索引立方体贴图的方式。 若要调整图像大小，请在“属性”窗口为“宽度”和“高度”属性指定新值。 例如，可将“宽度”和“高度”属性的值设置为 256。

3. 使用纯色填充纹理。 此纹理将位于立方体贴图的底部，对应台球桌表面。 记住下一纹理要使用的颜色。

4. 创建第二个纹理，大小与第一个纹理相同。 此纹理在立方体贴图的四面重复使用，对应台球桌的表面和侧面以及台球桌周围的区域。 务必在此纹理中使用与底部纹理相同的颜色绘制台球桌表面。 纹理应如下所示：

   ![立方体贴图的边的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_art_env_texture_side.png?view=vs-2019)

   请记住，反射贴图即使不如照片般逼真也能奏效；例如，本文中用于创建图像的立方体贴图只包含四个球带而非六个。

5. 创建第三个纹理，大小与其他两个纹理相同。 此纹理将位于立方体贴图的顶部，对应台球桌上方的天花板。为使这部分反射更为有趣，可绘制一个顶灯，加强在上一个过程中添加到着色器的反射高光。 纹理应如下所示：

   ![立方体贴图的顶部的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_art_env_texture_top2.png?view=vs-2019)

   现已为立方体贴图各个面创建了单独的纹理，可使用工具将其组合到可存储在单个 .dds 纹理中的立方体贴图中。 可使用任意程序创建立方体贴图，只要该程序能将立方体贴图另存为 .dds 纹理格式即可。 本演练演示如何使用 2010 年 6 月的 DirectX SDK 中的 DirectX 纹理工具创建纹理。

###### 使用 DirectX 纹理工具组合立方体贴图

1. 在 DirectX 纹理工具中的主菜单上，选择“文件” > “新建纹理”。 随机显示“新建纹理”对话框。

2. 在“纹理类型”组中，选择“立方体贴图纹理”。

3. 在“维度”组中，输入正确的“宽度”和“高度”值，然后选择“确定”。 随机显示新的纹理文档。 默认情况下，第一个在纹理文档中显示的纹理对应于“正 X”立方体面。

4. 将为纹理立方体侧面创建的纹理加载到立方体面。 在主菜单中，选择“文件” > “打开到此立方体贴图面”，选择为立方体侧面创建的纹理，然后选择“打开”。

5. 为“负 X”、“正 Z”和“负 Z”立方体面重复步骤 4。 若要执行此操作，必须查看想要加载的面。 若要查看其他立方体贴图面，请在主菜单上选择“查看” > “立方体贴图面”，然后选择要查看的面。

6. 对于“正 Y”立方体面，请加载为纹理立方体顶部创建的纹理。

7. 对于“负 Y”立方体面，请加载为纹理立方体底部创建的纹理。

8. 保存纹理。

   可将立方体贴图设想为具有如下布局：

   ![环境立方体贴图的布局](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_art_env_texture_top.png?view=vs-2019)

   顶部的图像是正 Y(+Y) 立方体面；中间，从左到右分别是是 -X、+Z、+X 和 -Z 立方体面；底部是 -Y 立方体面。

   现可修改着色器，将立方体贴图样本与着色器的其余部分混合。

###### 将环境映射添加到着色器

1. 使用添加混合修改着色器以包含环境映射部分。 着色器图应如下所示：

   ![两种反射着色器节点的特写](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_step_4b.png?view=vs-2019)

   请注意，可使用“乘加”节点来简化着色器图。

   以下是实现环境映射的着色器节点的更详细的视图：

   ![添加了环境映射的着色器关系图](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_step_4a.png?view=vs-2019)

2. 通过配置立方体贴图的纹理属性，应用在上一个过程中创建的纹理。 将“立方体贴图样本”节点的“纹理”属性的值设置为“纹理 2”，然后使用“纹理 2”属性组的“文件名”属性指定纹理文件。

3. 或者也可通过配置“常量”节点的“输出”属性来调整台球的反射率。 若要访问节点的属性，请选择该节点，然后在“属性”窗口中找到要访问的属性。

   应用环境映射后，台球应如下所示：

   ![环境映射的台球的特写](https://docs.microsoft.com/zh-cn/visualstudio/designers/media/gfx_shader_demo_billiard_ball_4.png?view=vs-2019)

   在此最终图像中，请注意为创建逼真台球组合所添加效果的方式。 形状、纹理和照明构造三维物体的基本外观，反射高光和反射使得台球更加有趣，使其与环境融为一体。

#### [Export a shader](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-export-a-shader?view=vs-2019)

本文演示如何使用着色器设计器导出有向图着色器语言 (DGSL) 着色器，使你能在应用中使用它。

##### 导出着色器

在使用着色器设计器创建着色器之后且在应用中使它之前，必须以图形 API 理解的格式将其导出。 可以用不同的方式导出着色器以满足不同的需求。

1. 在 Visual Studio 中，打开“视觉着色器图(.dgsl)”文件。

   如果没有要打开的“视觉着色器图 (.dgsl)”文件，请按照[如何：创建基本颜色着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-color-shader?view=vs-2019)中所述的步骤进行创建。

2. 在“着色器设计器”工具栏上，依次选择“高级” > “导出” > “导出为”。 显示“导出着色器”对话框。

3. 在“另存为类型”下拉列表中，选择要导出的格式。

   以下是可以选择的格式：

   **HLSL 象素着色器 (\*.hlsl)** 将着色器以高级着色器语言 (HLSL) 源代码导出。 使用此选项可随后对着色器进行修改，即使在应用中部署它后也可修改。 尽管这可以使根据最终用户问题对代码进行调试和修补更加容易，但也使用户能更容易地以你不希望的方式修改你的着色器（例如，在竞争性游戏中获得不公平的优势）。 它还会增加着色器的加载时间。

   **编译的象素着色器 (\*.cso)** 将着色器以 HLSL 字节码导出。 使用此选项可随后对着色器进行修改，即使在应用中部署它后也可修改。 它可以使根据最终用户问题对代码进行调试和修补更加容易，但由于着色器是预编译的，因此当应用加载该着色器时，它不会产生额外的运行时开销。 技术娴熟的用户仍然可以以你不希望的方式修改着色器，但编译着色器会大大增强其难度。

   **C++ 标头 (\*.h)** 将着色器以 C 样式标头导出，其定义包含 HLSL 字节码的字节数组。 此选项可能会使根据最终用户问题对代码进行调试和修补更加耗时，因为必须重新编译应用才能测试修补程序。 然而，因为此选项让用户难以（存在可能性）在着色器部署到应用后对其进行修改，因此也让用户难以以你不希望的方式修改着色器。

4. 在“文件名”组合框中，为导出的着色器指定名称，然后选择“保存”按钮。

## [Use 3D assets in your game or app](https://docs.microsoft.com/en-us/visualstudio/designers/using-3-d-assets-in-your-game-or-app?view=vs-2019)

本文介绍如何使用 Visual Studio 处理三维资产并将其包含在生成中。

在使用 Visual Studio 中的工具创建三维资产后，下一步是在应用中使用它们。 但是在使用它们之前，你的资产必须转换为 DirectX 可以解读的格式。 为帮助转换资产，Visual Studio 将为它可产生的每种资产提供生成自定义。若要将资产包含在生成中，你只需将项目配置为使用生成自定义、将资产添加到你的项目，然后将资产配置为使用正确的生成自定即可。 此后，你可以将资产加载到应用中，然后通过创建并填充 DirectX 资源来使用它们，正如你在任何其他 DirectX 应用中一样。

### 配置项目

在可将三维资产部署为生成的一部分之前，Visual Studio 必须了解所需部署的资产种类。 Visual Studio 已了解了很多常见的文件种类，但是因为仅某些种类的应用可使用三维资产，因此 Visual Studio 不会假设项目将生成这些种类的文件。 使用为每种资产类型提供的生成自定义（告知 Visual Studio 如何以有用的方式处理不同类型文件的文件），可告知 Visual Studio 应用使用这些种类的资产。 因为这些自定义可基于每个项目而进行应用，因此你只需向你的项目添加相应的自定义即可。

#### 将生成自定义添加到你的项目

1. 在“解决方案资源管理器”中，打开项目的快捷菜单，然后选择“生成依赖项” > “生成自定义”。 随即显示“Visual C++ 生成自定义文件”对话框。

2. 在“可用的生成自定义文件”下，选中希望在项目中使用的资产类型对应的复选框，如下表中所述：

   | 资产类型   | 生成自定义名称                             |
   | ---------- | ------------------------------------------ |
   | 纹理和图像 | ImageContentTask（.targets、.props）       |
   | 三维模型   | MeshContentTask（.targets、.props）        |
   | 着色器     | ShaderGraphContentTask（.targets、.props） |

3. 选择“确定” 按钮。

### 将资产包含在生成中

现在你的项目已了解你希望使用的不同种类的三维资产，下一步是告知它哪些文件是三维资产，以及它们的资产种类。

#### 将资产添加到生成

1. 在“解决方案资源管理器”中，在项目中打开资产的快捷菜单，然后选择“属性”。 随即显示资产的“属性页”对话框。

2. 请确保将“配置”和“平台”属性设置为你希望更改应用的值。

3. 在“配置属性”下，选择“常规”，然后在“常规”下的属性网格中，将“项目类型”属性设置为相应的内容管道项目类型。 例如，对于图像或纹理文件，请选择“图像内容管道”。

   Important

   默认情况下，Visual Studio 假设应使用内置于 Visual Studio 中“图像”项目类型对很多种类的图像文件进行分类。 因此，必须更改你希望通过图像内容管道处理的每个图像的“项目类型”属性。 三维模型和视觉着色器图形的内容管道源文件的其他类型默认为正确的“项目类型”。

4. 选择“确定” 按钮。

下面是三种内容管道项目类型及其关联的源文件类型和输出文件类型。

| 项目类型       | 源文件类型                                                   | 输出文件格式          |
| -------------- | ------------------------------------------------------------ | --------------------- |
| 图像内容管道   | 可移植网络图形 (.png)  JPEG（.jpg、.jpeg、.jpe、.jfif）  直接绘画表面 (.dds)  图形交换格式 (.gif)  位图（.bmp、.dib）  标记图像文件格式（.tif、.tiff）  Targa (.tga) | 直接绘画表面 (.dds)   |
| 网格内容管道   | Autodesk FBX 交换文件 (.fbx)  Collada DAE 文件 (.dae)  Wavefront OBJ 文件 (.obj) | 三维网格文件 (.cmo)   |
| 着色器内容管道 | 视觉对象着色器图 (.dgsl)                                     | 编译着色器输出 (.cso) |

### 配置资产内容管道属性

你可以设置每个资产文件的内容管道属性，以便它将以特定的方式生成。

#### 配置内容管道属性

1. 在“解决方案资源管理器”中，在你的项目中打开资产文件的快捷菜单，然后选择“属性”。 随即显示资产的“属性页”对话框。
2. 请确保将“配置”和“平台”属性设置为你希望更改应用到的值。
3. 在“配置属性”下，选择内容管道节点（例如，纹理和图像资产的“图像内容管道”），然后在属性网格中，将属性设置为相应的值。 例如，若要在生成时为纹理资产生成 mipmap，请将“生成 Mip”属性设置为“是”。
4. 选择“确定” 按钮。

#### 图像内容管道配置

使用图像内容管道工具生成纹理资产时，你可以采用各种方式压缩纹理、指示生成时是否应该生成 MIP 级别，以及更改输出文件的名称。

| Property              | 说明                                                         |
| --------------------- | ------------------------------------------------------------ |
| 压缩                  | 指定用于输出文件的压缩类型。  可用选项为：  - 不进行压缩 - BC1_UNORM 压缩 - BC1_UNORM_SRGB 压缩 - BC2_UNORM 压缩 - BC2_UNORM_SRGB 压缩 - BC3_UNORM 压缩 - BC3_UNORM_SRGB 压缩 - BC4_UNORM 压缩 - BC4_SNORM 压缩 - BC5_UNORM 压缩 - BC5_SNORM 压缩 - BC6H_UF16 压缩 - BC6H_SF16 压缩 - BC7_UNORM 压缩 - BC7_UNORM_SRGB 压缩  有关不同版本的 DirectX 中支持哪些压缩格式的信息，请参阅 [DXGI 编程指南](http://go.microsoft.com/fwlink/p/?LinkId=246265)。 |
| 转换为预乘 alpha 格式 | 若要将输出文件中的图像转换为预乘 alpha 格式，则为“是”；否则为“否”。 仅更改输出文件，源图像未发生更改。 |
| **生成 Mip**          | 若要在生成时生成完整的 MIP 链并将它包含在输出文件中，则为“是”；否则为“否”。 如果为“否”且源文件已经包含 mipmap 链，则输出文件将具有 MIP 链；否则，输出文件将没有 MIP 链。 |
| 内容输出              | 指定输出文件的名称。 **重要提示：** 更改输出文件的文件扩展名不会影响其文件格式。 |

#### 网格内容管道配置

使用网格内容管道工具生成网格资产时，你可以更改输出文件的名称。

| Property | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| 内容输出 | 指定输出文件的名称。 **重要提示：** 更改输出文件的文件扩展名不会影响其文件格式。 |

#### 着色器内容管道配置

使用着色器内容管道工具生成着色器资产时，你可以更改输出文件的名称。

| Property | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| 内容输出 | 指定输出文件的名称。 **重要提示：** 更改输出文件的文件扩展名不会影响其文件格式。 |

### 在运行时加载和使用三维资产

#### 使用纹理和图像

Direct3D 提供了用于创建纹理资源的功能。 在 Direct3D 11 中，D3DX11 实用工具库提供了用于直接从图像文件创建纹理资源和资源视图的其他功能。 有关如何在 Direct3D 11 中创建纹理资源的详细信息，请参阅[纹理](http://go.microsoft.com/fwlink/p/?LinkID=246267)。 有关如何使用 D3DX11 库从图像文件创建纹理资源或资源视图的详细信息，请参阅[如何：从文件初始化纹理](http://go.microsoft.com/fwlink/p/?LinkId=246268)。

#### 使用三维模型

Direct3D 11 不提供用于从三维模型创建资源的功能。 相反，必须编写代码，该代码读取三维模型文件并创建表示三维模型和该模型所需的任何资源（例如，纹理或着色器）的顶点和索引缓冲区。

#### 使用着色器

Direct3D 提供了用于创建着色器资源并将其绑定到可编程的图形管道的功能。 有关如何在 Direct3D 中创建着色器资源并将其绑定到管道的详细信息，请参阅 [HLSL 编程指南](http://go.microsoft.com/fwlink/p/?LinkID=261521)。

在可编程的图形管道中，每个管道阶段都必须为下一个管道阶段提供一个以它可理解的方式进行格式化的结果。因为着色器设计器仅可创建像素着色器，所以这意味着你的应用应确保它接收的数据将采用所预期的格式。 以下几个可编程的着色器阶段可在像素着色器之前出现并执行几何变换：顶点着色器、外壳着色器、域着色器和几何着色器。 不可编程的分割阶段也可在像素着色器之前出现。 无论那些阶段直接出现在像素着色器之前，它都必须采用以下格式提供其结果：

```hlsl
struct PixelShaderInput
{
    float4 pos : SV_POSITION;
    float4 diffuse : COLOR;
    float2 uv : TEXCOORD0;
    float3 worldNorm : TEXCOORD1;
    float3 worldPos : TEXCOORD2;
    float3 toEye : TEXCOORD3;
    float4 tangent : TEXCOORD4;
    float3 normal : TEXCOORD5;
};
```

根据你在着色器中使用的着色器设计器节点，你可能还必须提供采用遵循以下定义的格式的其他数据：

```hlsl
Texture2D Texture1 : register( t0 );
Texture2D Texture2 : register( t1 );
Texture2D Texture3 : register( t2 );
Texture2D Texture4 : register( t3 );
Texture2D Texture5 : register( t4 );
Texture2D Texture6 : register( t5 );
Texture2D Texture7 : register( t6 );
Texture2D Texture8 : register( t7 );

TextureCube CubeTexture1 : register( t8 );
TextureCube CubeTexture2 : register( t9 );
TextureCube CubeTexture3 : register( t10 );
TextureCube CubeTexture4 : register( t11 );
TextureCube CubeTexture5 : register( t12 );
TextureCube CubeTexture6 : register( t13 );
TextureCube CubeTexture7 : register( t14 );
TextureCube CubeTexture8 : register( t15 );

SamplerState TexSampler : register( s0 );

cbuffer MaterialVars : register (b0)
{
    float4 MaterialAmbient;
    float4 MaterialDiffuse;
    float4 MaterialSpecular;
    float4 MaterialEmissive;
    float MaterialSpecularPower;
};

cbuffer LightVars : register (b1)
{
    float4 AmbientLight;
    float4 LightColor[4];
    float4 LightAttenuation[4];
    float3 LightDirection[4];
    float LightSpecularIntensity[4];
    uint IsPointLight[4];
    uint ActiveLights;
}

cbuffer ObjectVars : register(b2)
{
    float4x4 LocalToWorld4x4;
    float4x4 LocalToProjected4x4;
    float4x4 WorldToLocal4x4;
    float4x4 WorldToView4x4;
    float4x4 UVTransform4x4;
    float3 EyePosition;
};

cbuffer MiscVars : register(b3)
{
    float ViewportWidth;
    float ViewportHeight;
    float Time;
};
```

### 相关主题

| Title                                                        | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [如何：导出包含 mipmap 的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-texture-that-contains-mipmaps?view=vs-2019) | 描述如何使用“图像内容管道”导出包含预计算 mipmap 的纹理。     |
| [如何：导出包含预乘 Alpha 的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-texture-that-has-premultiplied-alpha?view=vs-2019) | 描述如何使用“图像内容管道”导出包含预乘 alpha 值的纹理。      |
| [如何：导出纹理以用于 Direct2D 或 Javascipt 应用](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-texture-for-use-with-direct2d-or-javascipt-apps?view=vs-2019) | 描述如何使用“图像内容管道”导出可在 Direct2D 或 JavaScript 应用中使用的纹理。 |
| [处理游戏和应用的三维资产](https://docs.microsoft.com/zh-cn/visualstudio/designers/working-with-3-d-assets-for-games-and-apps?view=vs-2019) | 描述 Visual Studio 提供的用于创建和操作三维资产（包括纹理和图像、三维模型和着色器）的编辑工具。 |
| [如何：导出着色器](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-shader?view=vs-2019) | 描述如何从着色器设计器中导出着色器。                         |

### [Export a texture that contains mipmaps](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-export-a-texture-that-contains-mipmaps?view=vs-2019)

在项目生成阶段，图像内容管道可从源图像生成 mipmap。 若要实现某些效果，有时必须手动指定每个 MIP 级别的图像内容。 无需手动指定每个 MIP 级别的图像内容时，在生成时生成 mipmap 可确保 mipmap 内容一直保持同步。还可避免在运行时生成 mipmap 的性能成本。

本文包含以下内容：

- 将源映像配置为由图像内容管道进行处理。
- 配置图像内容管道，生成 mipmap。

#### 导出 mipmap

Mipmapping 为 3D 游戏或应用中的带纹理图面提供自动屏幕空间细节层次。 它可通过预先计算纹理的向下采样版本，增强游戏或应用的渲染性能。 通过预先计算下采样版本，每次采样时，不必对整个纹理进行向下采样。

##### 导出包含 mipmap 的纹理

1. 从基本纹理开始。 加载现有图像文件，或根据[如何：创建基本纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-texture?view=vs-2019)所述，创建一个纹理。 若要支持 mipmap，请指定一个宽度和高度尺寸都是 2 的同次幂的纹理，如 64x64、256x256 或 512x512。

2. 配置刚刚创建的纹理文件，使其由图像内容管道进行处理。 在“解决方案资源管理器”中，打开创建的纹理文件的快捷菜单，然后选择“属性”。 在“配置属性” > “常规”页上，将“项目类型”属性设置为“图像内容管道”。 请确保将“内容”属性设置为“是”，并且将“从生成中排除”设置为“否”。 选择“应用”。

   将出现“图像内容管道”配置属性页。

3. 配置图像内容管道，生成 mipmap。 在“配置属性” > “图像内容管道” > “常规”页上，将“生成 Mip”属性设置为“是(/generatemips)”。

4. 选择“确定”。

生成项目后，图像内容管道会将源图像从工作格式转换为指定的输出格式（包括 MIP 级别）。 将结果复制到项目的输出目录。

### [Export a texture that has premultiplied alpha](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-export-a-texture-that-has-premultiplied-alpha?view=vs-2019)

图像内容管道可从源图像生成预乘 Alpha 纹理。 这些纹理比不包含预乘 alpha 的纹理更易于使用且更可靠。

本文档演示了这些活动：

- 将源映像配置为由图像内容管道进行处理。
- 配置图像内容管道以生成预乘 alpha。

#### 预乘 Alpha

预乘 Alpha 相对于常规非预乘 Alpha 来说具有若干优点，因为它通过透明度（允许通过的底色的量）来分离纹素添加的颜色（纹素添加到场景中的颜色），更好的体现了现实世界与物理材质的光线交互。 使用预乘 Alpha 的一些优点为：

- 与预乘 Alpha 混合的是一种结合性运算，无论按何种顺序混合纹理，混合多个半透明纹理的结果都是相同的。
- 因为混合预乘 Alpha 具有结合性，所以简化了半透明对象的多通渲染。
- 通过使用预乘 Alpha，可以同时实现纯附加混合（通过将 Alpha 设置为零）和线性内插混合。 例如，在粒子系统中，附加混合火粒子可能会成为通过使用线性内插混合成的半透明烟粒子。 如果没有预乘 Alpha，将需要在烟粒子之外单独绘制火粒子，并修改绘图调用间的呈现状态。
- 使用预乘 Alpha 时，纹理拥有更高的压缩质量，并且它们不显示变色的边缘（或“晕轮效应”），这种边缘会在混合不使用预乘 alpha 的纹理时出现。

##### 创建使用预乘 Alpha 的纹理

1. 从基本纹理开始。 加载现有图像文件，或根据[如何：创建基本纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-texture?view=vs-2019)中所述进行创建。

2. 配置纹理文件，使其由图像内容管道进行处理。 在“解决方案资源管理器”中，打开纹理文件的快捷菜单，然后选择“属性”。 在“配置属性” > “常规”页上，将“项目类型”属性设置为“图像内容管道”。 请确保将“内容”属性设置为“是”，并且将“从生成中排除”设置为“否”，然后选择“应用”按钮。 将出现“图像内容管道”配置属性页。

3. 配置图像内容管道，生成预乘 Alpha。 在“配置属性” > “图像内容管道” > “常规”页上，将“转换为预乘 Alpha 格式”属性设置为“是 (/generatepremultipliedalpha)”。

4. 选择“确定” 按钮。

   生成项目后，图像内容管道将源图像从工作格式转换为指定的输出格式，其中包括将图像转换为预乘 Alpha 格式，该结果将复制到项目的输出目录中。

### [Export a texture for use with Direct2D or Javascipt apps](https://docs.microsoft.com/en-us/visualstudio/designers/how-to-export-a-texture-for-use-with-direct2d-or-javascipt-apps?view=vs-2019)

图像内容管道可以生成与 Direct2D 的内部呈现约定兼容的纹理。 这种类型的纹理适合在使用 Direct2D 的应用和使用 JavaScript 创建的 UWP 应用中使用。

本文档演示了这些活动：

- 将源映像配置为由图像内容管道进行处理。
- 配置图像内容管道以生成可在 Direct2D 或 JavaScript 应用中使用的纹理。
  - 生成块压缩的 .dds 文件。
  - 生成预乘的 Alpha。
  - 禁用 mipmap 生成。

#### Direct2D 中的呈现约定

Direct2D 的上下文中使用的纹理必须符合这些 Direct2D 内部呈现约定：

- Direct2D 通过使用预乘的 Alpha 实现透明度和半透明度。 与 Direct2D 一起使用的纹理必须包含预乘的 Alpha，即使该纹理不使用透明度或半透明度也是如此。 有关预乘 Alpha 的详细信息，请参阅[如何：导出包含预乘 Alpha 的纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-export-a-texture-that-has-premultiplied-alpha?view=vs-2019)。
- 必须通过使用以下块压缩格式之一以 .dds 格式应用纹理：
  - BC1_UNORM 压缩
  - BC2_UNORM 压缩
  - BC3_UNORM 压缩
- 不支持 mipmap。

##### 创建与 Direct2D 呈现约定相兼容的纹理

1. 从基本纹理开始。 加载现有映像，或如[如何：创建基本纹理](https://docs.microsoft.com/zh-cn/visualstudio/designers/how-to-create-a-basic-texture?view=vs-2019)中所述，创建一个新纹理。 若要支持 .dds 格式的块压缩，请指定宽度和高度为 4 的倍数（例如，100x100、128x128 或 256x192）的纹理。 由于不支持 mipmapping，因此纹理无需为正方形，并且大小无需为 2 的幂。

2. 配置纹理文件，使其由图像内容管道进行处理。 在“解决方案资源管理器”中，打开刚刚创建的纹理文件的快捷菜单，然后选择“属性”。 在“配置属性” > “常规”页上，将“项目类型”属性设置为“图像内容管道”。 请确保将“内容”属性设置为“是”，并且将“从生成中排除”设置为“否”，然后选择“应用”按钮。 将出现“图像内容管道”配置属性页。

3. 将输出格式设置为块压缩的格式之一。 在“配置属性” > “图像内容管道” > “常规”页上，将“压缩”属性设置为“BC3_UNORM 压缩 (/compress:BC3_UNORM)”。 根据具体需求，还可以选择任何其他的 BC1、BC2 或 BC3 格式。 Direct2D 当前不支持 BC4、BC5、BC6 或 BC7 纹理。 有关不同 BC 格式的详细信息，请参阅 [Block Compression (Direct3D 10)](https://docs.microsoft.com/zh-cn/windows/desktop/direct3d10/d3d10-graphics-programming-guide-resources-block-compression)（块压缩 (Direct3D 10)）。

   Note

   指定的压缩格式确定图像内容管道生成的文件的格式。 这不同于“图像编辑器”中源映像的“格式”属性，该“格式”属性确定存储在磁盘上时源映像文件的格式 - 即工作格式。 通常情况下，不需要已压缩的工作格式。

4. 配置图像内容管道以生成使用预乘的 Alpha 的输出。 在“配置属性” > “图像内容管道” > “常规”页上，将“转换为预乘 Alpha 格式”属性设置为“是 (/generatepremultipliedalpha)”。

5. 配置图像内容管道，使其不生成 mipmap。 在“配置属性” > “图像内容管道” > “常规”页上，将“生成 Mip”属性设置为“否”。

6. 选择“确定” 按钮。

   生成项目时，图像内容管道会将源图像从工作格式转换为指定的输出格式（转换包括生成预乘 Alpha），并且结果将被复制到项目的输出目录。