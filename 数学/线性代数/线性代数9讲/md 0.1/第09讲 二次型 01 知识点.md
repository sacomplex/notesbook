# 第09讲 二次型

## 9.1 二次型的定义及其矩阵表达式
$n$元变量$x_1,x_2,\cdots,x_n$的二次齐次多项式
- 完全展开式：
  - $f(x_1,x_2,\cdots,x_n) = （a_{11}x_1^2 + 2a_{12}x_1^2x_1x_2 + \cdots + 2a_{1n}x_1x_n) $
  - ​                                                             $+ (a_{22}x_2^2 + \cdots + 2a_{2n}x_2x_n) + $
  - ​                                                                                                 $\cdots $
  - ​                                                                                                $+ (a_{nn}x_n^2)$
- 称为$n$元二次型,简称二次型
  - 目前只研究$a_{ij} \in (i \leqslant j, i,j = 1,2,\cdots,n)$的情况,且称此二次型$f$为实二次型   

因此$x_ix_j = x_jx_i$，

- 现若令$a_{ij} = a_{ji}(i,j = 1,2,\cdots,n)$，
  - 则$2a_{ij}x_ix_j = a_{ij}x_ix_j + a_{ji}x_jx_i$
- 于是
  - 和式：$f(x_1,x_2,\cdots,x_n) = \sum_{i = 1}^{\infty}\sum_{j = 1}^{\infty}a_{ij}x_ix_j$
- 令

$$
A = \begin{bmatrix}
a_{11} &  a_{12}&  \cdots& a_{1n} \\ 
a_{21} &  a_{22}&  \cdots& a_{2n} \\ 
\vdots & \vdots &        & \vdots \\ 
a_{n1} &  a_{n=2}&  \cdots& a_{nn} 
\end{bmatrix}   
,x = \begin{bmatrix}
x_1\\ 
x_2\\ 
\vdots\\ 
x_n
\end{bmatrix}
$$
- 则二次型可表示为
  - 二次型的矩阵表达式：$f(x) = x^TAx(A^T = A)$

> 二次型的矩阵$A$是一个对称矩阵,其中$A = (a_{ij}),a_{ij} = a_{ij}$,即满足$A^T = A$    
> 原因:  
> 二次型可以有不同种的写法
>
> - 三元二次型$f(x_1, x_2, x_3)$有不同种的写法 
>   - $f(x_1, x_2, x_3) = x_1^2 + x_2^2 + x_1^3 + 4x_1x_2$
>   - $f(x_1, x_2, x_3) = x_1^2 + x_2^2 + x_1^3 + x_1x_2 + 3x_2x_1$
>   - $f(x_1, x_2, x_3) = x_1^2 + x_2^2 + x_1^3 + 2x_1x_2 + 2x_2x_1$
>
> - 对应地用矩阵表示也有多种形式  
>
> 说明了二次型的矩阵不唯一,为了方便研究,就规定二次型的矩阵必须实对称矩阵  

## 9.2 合同变换,二次型的合同标准形,规范形  

### 线性变换的定义
对于$n$二次型$f(x_1,x_2,\cdots,x_n)$,若令  
$$
\left\{\begin{matrix}
x_1 = c_{11}y_1 + c_{12}y_2 + \cdots + c_{1n}y_n ,\\ 
x_2 = c_{21}y_1 + c_{22}y_2 + \cdots + c_{2n}y_n ,\\ 
\cdots \\ 
x_n = c_{n1}y_1 + c_{n2}y_2 + \cdots + c_{nn}y_n ,
\end{matrix}\right.
$$
记
$$
x = \begin{bmatrix}
x_1\\ 
x_2\\ 
\vdots\\ 
x_n
\end{bmatrix}  
,  
C = \begin{bmatrix}
c_{11} &c_{12}  &\cdots  & c_{1n}\\ 
c_{21} &c_{22}  &\cdots  & c_{2n}\\ 
\vdots &\vdots  &  & \vdots\\ 
c_{n1} &c_{n2}  &\cdots  & c_{nn} 
\end{bmatrix}  
,  
y \begin{bmatrix}
y_1\\ 
y_2\\ 
\vdots\\ 
y_n
\end{bmatrix}
$$
则可以写成$x = Cy$  

**线性变换**  
- 从$y_1,y_2,\cdots,y_n$到$x_1,x_2,\cdots,x_n$    

**可逆线性变换**  
- 若线性变换的系数矩阵$C$可逆,即$|C| \neq 0$ 



现给出$f(x) = x^TAx$, 令$x = Cy$

- 则$f(x) = {(Cy)}^TA{(Cy)} = y^T(C^TAC)y$
  - 记$B =C^TAC$
  - 则$f(x) = y^TBy = g(y)$
- 此时,二次型$f(x) = x^TAx$通过线性变换$x = Cy$得到一个新二次型$g(y) = y^TBy$

### 矩阵合同的定义与性质  
上述二次型$f(x)$与$g(x)$的矩阵$A$与$B$的关系$B = C^TAC$  

定义:  
设$A,B$为$n$阶实对称矩阵,

若存在可逆矩阵$C$,

- 使得$C^TAC = B$,则称$f(x)$与$g(x)$合同
- 记作$A \simeq B$
- 此时称$f(x)$与$g(x)$为合同二次型  

> 在二次型中,$A$与$B$的合同,就是指同一个二次型在可逆线性变换下的两种不同状态的联系  

合同具有反身性,对称性,传递性     

特别指出:   
- 由矩阵合同的定义知,$A \simeq B$,则有$r(A) = r(B)$.
    - 因此，可逆线性变换不会改变二次型的秩  
- 二次型的矩阵都是对称矩阵,所以和对称矩阵合同的矩阵也必须是对称矩阵
    - 若$A \simeq B$,即存在可逆矩阵$C$
    - 使得$C^TAC = B$
      - 其中$A^T = A$
    - 则$B^T = {C^TAC}^T = C^TA^TC = C^TAC = B$

### 二次型的标准形,规范形

#### 标准形:

若二次型中只含有平方项,没有交叉项(即所有交叉项的系数全为0)

- 即形如$d_1x_1^2 + d_2x_2^2 + \cdots + d_nx_n^2$

#### 规范形:   
若标准型中,系数$d_i(i = 1,2,\cdots,n)$仅为$1,-1,0$
- 即形如$x_1^2 + \cdots + x_p^2 - x_{p+1^2} - \cdots - x_{p+q}^2$  

#### 合同标准形  
若二次型$f(x) = x^TAx$合同于标准形$d_1x_1^2 + d_2x_2^2 + \cdots + d_nx_n^2$,
- 则称$d_1x_1^2 + d_2x_2^2 + \cdots + d_nx_n^2$为$f(x)$的合同标准型   

#### 合同规范形  
若二次型$f(x) = x^TAx$合同于规范形$x_1^2 + \cdots + x_p^2 - x_{p+1^2} - \cdots - x_{p+q}^2$ 
- 则称$x_1^2 + \cdots + x_p^2 - x_{p+1^2} - \cdots - x_{p+q}^2$为$f(x)$的合同规范形     



方法一: (拉格朗日配方法)任何二次型均可通过配方法(作可逆线性变换)化成标准形及规范形
用矩阵语言表达:
任何实对称矩阵$A$必存在可逆矩阵$C$,使得$C^TAC = \Lambda$,其中

- 标准形
$$
\Lambda = \begin{bmatrix}
d_1 &  &  & \\ 
 &  d_2&  & \\ 
 &  & \ddots&  \\ 
 &  &  & d_n
\end{bmatrix}
$$
> 即标准形的变量的系数为对角矩阵的元素

- 规范形
$$
\begin{bmatrix}
1 &  &  &  &  &  &  &  & \\ 
 &\ddots &  &  &  &  &  &  & \\ 
 &  &1  &  &  &  &  &  & \\ 
 &  &  &-1  &  &  &  &  & \\ 
 &  &  &  &\ddots  &  &  &  & \\ 
 &  &  &  &  &-1  &  &  & \\ 
 &  &  &  &  &  &0  &  & \\ 
 &  &  &  &  &  &  &\ddots  & \\ 
 &  &  &  &  &  &  &  &0
\end{bmatrix}
$$



方法二: 也可以通过正交变换化成标准形,

- 用矩阵语言表达: 任何实对称矩阵$A$一定存在正交矩阵$Q$,使得$Q^{-1}AQ = Q^TAQ = \Lambda$,其中  

$$
\Lambda = \begin{bmatrix}
\lambda_1 &  &  & \\ 
 &  \lambda_2&  & \\ 
 &  & \ddots&  \\ 
 &  &  & \lambda_n
\end{bmatrix}
$$
## 9.3 惯性定理  
无论选取什么样的可逆线性变换,将二次型化成标准形或规范形,其正项之数$p$,负项之数$q$都是不变的,$p$称为正惯性指数,$q$称为负惯性指数  

> - 若二次型的秩为$r$,则$r = p + q$,合同变换不改变正,负惯性指数
> - 两个二次型(或实对称矩阵)合同的充要条件是
>   - 有相同的正,负惯性指数或有相同的秩及正(或负)惯性指数

## 9.4 正定二次型及其判别

$n$元二次型$f(x_1,x_2,\cdots,x_n) = x^TAx$.

若对任意的$x = {[x_1,x_2,\cdots,x_n]}^T \neq 0$,均有$x^TAX > 0$,

- 则称$f$为正定二次型
- 称二次型的对应矩阵$A$为正定矩阵

### 二次型正定的充要条件

$n$元二次型$f(x_1,x_2,\cdots,x_n) = x^TAx$正定  
- $\Leftrightarrow$对任意$x \neq 0$
  - 有$x^T A x > 0$(定义)  
- $\Leftrightarrow f$的正惯性指数$p = n$
- $\Leftrightarrow$存在可逆矩阵$D$
  - 使$A = D^TD$
- $\Leftrightarrow A \simeq E$
- $\Leftrightarrow A$的特征值$\lambda_i > 0(i = 1,2,...,n)$
- $\Leftrightarrow A$的全部顺序主子式均大于$0$
  - 常用于三阶的数值矩阵

### 二次型正定的必要条件

- $a_{ii} > 0(i = 1,2,...,n)$
- $|A| > 0$

## 题型和补充

### 题型

#### 二次型的矩阵表示
二次型就是二次齐次函数
为了用线性代数的方法研究它,首先要将其表示成矩阵形式

- $f(x_1,x_2,\cdots,x_n) = x^T Ax$
  - $A^T = A$
    - $A$是实对称矩阵
  - $x = [x_1,x_2,\cdots,x_n]^T 是列向量$

此时二次型的矩阵表达式是唯一的,$f$与$A$一一对应

#### 用配方法化二次型为标准形

- 遵循将某个变量的平方项及与其有关的混合项一次配完,配成一个完全平方,减少一个未配完全平方,使得总的平方项的项数小于等于变量的个数
  - 目的是保证所用变换是可逆的
- 当总的完全平方项的项数小于变量的个数时,需要对其补充用$0$作为系数
  - $f(x_1,x_2,x_3) = (x_1,x_2,x_3)^2 - 2(x_2+x_3)^2 + 0x_3^2$
    - $y_1 = x_1+x_2+x+3$
    - $y_2 = x_2+x_3$
    - $y_3=x_3$
- 没有平方项(或者平方项较少),需要做可逆线性变换,使其出现平方项,然后再配完全平方
  - 若$a_{ij} \neq 0, i \neq j$,作可逆线性变换
    - $x_i = y_i-y_j$
    - $x_j=y_i+y_j$
    - $x_k = y_k$,$ (k = 1,2,\cdots,n)$且$k \neq i,j$
  - 例如
    - $f(x_1,x_2,x_3) = x_1x_2+x_1x_3-x_2x_3$
      - $x_1=y_1+y_2$
      - $x_2=y_1-y_2$
      - $x_3=y_3$
      - 一加一减是为了使$x_ix_j,i \neq j$平方差公式,将交叉项变为平方项
    - $f(x_1,x_2,x_3) = x_2^2+2x_1x_3$
      - $x_1 = y_1+y_3$
      - $x_3=y_1-y_3$
      - $x_2=y_2$
- 配方法中的配方次序可以不同,故所作
  - 可逆线性变换不唯一
  - 标准形不唯一
  - 但标准形中不为零的项数$r(f)$,正项个数(正惯性指数),负项个数(负惯性指数)是不变的

> 任何实对称矩阵$A$,必存在可逆矩阵$C$,使得$C^TAC= \Lambda$,其中$\Lambda$是对角矩阵,或是对角元素只取$-1,0,1$的对角矩阵

#### 正交变换二次型为标准形
当写出二次型的矩阵$A$时,便成了"将$A$用正交矩阵相似对角化"的问题了

正交变化只能化二次型为标准形,不能化为规范形(除非特征值都属于$\{-1,0,1\}$)

正交变换不唯一,但是标准形是唯一的,求得特征值后即可得标准形为$\lambda_1y_1^2 + \lambda_2y_2^2 + \cdots + \lambda_ny_n^2$
- 疑问:
  - 如何保证特征值的顺序?
  - 是先重根,然后单根?
  - 从而得出标准形?

可进行验算
- $\sum_{i=1}^n\lambda_i = \sum_{i=1}^na_{ii}, |A|=\prod_{i=1}^n\lambda_i $

#### 合同矩阵与合同二次型
选择题判断两个矩阵是否为合同矩阵判断标准形
- 将矩阵化为对应的二次型,经过配方,找出$r(f)$,判断正负惯性指数是否相等
- 求出矩阵的特征值,得到标准形,判断正负惯性指数是否相等
  - 还可以借助,辅助判断正负惯性指数$p,q$
    - $\sum_{i=1}^n\lambda_i = \sum_{i=1}^na_{ii}$
    - $\prod _{i=0}^n\lambda_i = |A|$

#### 判定二次型的正定性
正定二次型及其判别
- 二次型正定的充要条件
- 二次型正定的必要条件

#### 正定矩阵的证明
正定二次型及其判别
- 二次型正定的充要条件
- 二次型正定的必要条件

#### 矩阵的等价,相似,合同

$A,B$是同型矩阵, 若$A,B$等价

- $\Leftrightarrow$$A$经过有限次初等变换得$B$
- $\Leftrightarrow$有可逆矩阵$P,Q$,使得$PAQ = B$
- $\Leftrightarrow$$r(A) = r(B)$ 

> 证明两个矩阵等价,证明秩相等比较简单

$A,B$是同阶方阵,若$A,B$相似

- $\Leftrightarrow$有可逆矩阵$P$,是$P^{-1}AP=B$

> 证明两个矩阵相似,可以通过证明两个矩阵分别相似于同一个对角矩阵或者说有相同特征值

$A,B$是同阶方阵,若$A,B$合同

- $\Leftrightarrow$有可逆矩阵$C$,使$C^TAC = B$
- $\Leftrightarrow$$x^TAx,x^TBx$有相同的正,负惯性指数,或有相同的秩及正(或负)惯性指数

> 证明两个矩阵合同,
>
> - 可以通过两个矩阵的特征值来比较
> - 或者需要变换出标准形来比较正,负惯性指数



### 补充

$A$是$n$阶方阵, 对任意$x = [x_1,x_2,\cdots,x_n]^T$若$x^T A x = 0$,$A$不一定为$O$(9.1)



$A$是$n$阶实对称方阵, 对任意$x = [x_1,x_2,\cdots,x_n]^T$,若$x^T A x = 0$,$A$一定为$O$(9.1)

$(x_1+x_2+x_3)^2 = x_1^2 + x_2^2 +x_3^2 + 2x_1x_2+2x_1x_3+2x_2x_3$



$A$正定

- $\Rightarrow $$A^{-1}$正定
- $\Rightarrow $$kA, k>0$正定
- $\Rightarrow $ $A^k$正定
- $\Rightarrow $$A^*$正定
- $\Rightarrow $$f(A)$正定

$A$正定

- $\Rightarrow $$A$对称,满秩
- $\Rightarrow $$A$可逆,$A^{-1}$存在,且$(A^{-1})^T = (A^T)^{-1}$,$A^{-1}$对称



若$a_1 < a_2 < \cdots < a_n , b_i \neq 0$则$
a_1 \leqslant \frac{a_1b_1^2 + a_2b_2^2 + \cdots + a_nb_n^2}{b_1^2 + b_2^2 + \cdots + b_n^2} \leqslant a_n$